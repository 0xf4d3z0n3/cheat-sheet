<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Windows Digital Forensics CTF Cheat Sheet - Comprehensive Quick Reference Guide">
    <title>Windows Digital Forensics CTF Cheat Sheet</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Fira+Code:wght@300;400;500;600;700&family=JetBrains+Mono:wght@300;400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap');

        :root {
            --bg: #0a0a0f;
            --bg2: #0d0d15;
            --card: rgba(13, 13, 25, 0.8);
            --card-h: rgba(20, 20, 40, 0.9);
            --bdr: rgba(0, 255, 255, 0.15);
            --bdr-h: rgba(0, 255, 255, 0.4);
            --cy: #00ffff;
            --cy2: #00a5a5;
            --mg: #ff00ff;
            --mg2: #a500a5;
            --lm: #00ff88;
            --lm2: #00a555;
            --og: #ff8800;
            --rd: #ff3355;
            --yw: #ffdd00;
            --t1: #e0e0ff;
            --t2: #8888aa;
            --t3: #555577;
            --codebg: rgba(0, 255, 255, 0.05);
            --tr: 0.3s cubic-bezier(0.4, 0, 0.2, 1)
        }

        .light-mode {
            --bg: #f0f0f5;
            --bg2: #e8e8f0;
            --card: rgba(255, 255, 255, 0.9);
            --card-h: rgba(255, 255, 255, 1);
            --bdr: rgba(0, 100, 150, 0.2);
            --bdr-h: rgba(0, 100, 150, 0.5);
            --cy: #0088aa;
            --cy2: #006688;
            --mg: #aa00aa;
            --mg2: #880088;
            --lm: #008844;
            --lm2: #006633;
            --t1: #1a1a2e;
            --t2: #555577;
            --t3: #8888aa;
            --codebg: rgba(0, 100, 150, 0.08)
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box
        }

        html {
            scroll-behavior: smooth;
            scrollbar-width: thin;
            scrollbar-color: #1a1a3a #0a0a15
        }

        body {
            font-family: 'Inter', 'Fira Code', monospace;
            background: var(--bg);
            color: var(--t1);
            line-height: 1.7;
            overflow-x: hidden;
            min-height: 100vh
        }

        ::-webkit-scrollbar {
            width: 8px
        }

        ::-webkit-scrollbar-track {
            background: #0a0a15
        }

        ::-webkit-scrollbar-thumb {
            background: #1a1a3a;
            border-radius: 4px
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--cy2)
        }

        #progress-bar {
            position: fixed;
            top: 0;
            left: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--cy), var(--mg), var(--lm));
            z-index: 10000;
            transition: width .1s linear;
            box-shadow: 0 0 10px var(--cy), 0 0 20px var(--mg)
        }

        .bg-grid {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: linear-gradient(rgba(0, 255, 255, 0.03) 1px, transparent 1px), linear-gradient(90deg, rgba(0, 255, 255, 0.03) 1px, transparent 1px);
            background-size: 50px 50px;
            pointer-events: none;
            z-index: 0
        }

        .light-mode .bg-grid {
            background-image: linear-gradient(rgba(0, 100, 150, 0.05) 1px, transparent 1px), linear-gradient(90deg, rgba(0, 100, 150, 0.05) 1px, transparent 1px)
        }

        .hero {
            text-align: center;
            padding: 60px 20px 30px;
            position: relative;
            z-index: 1;
            background: linear-gradient(180deg, rgba(0, 255, 255, 0.03) 0%, transparent 100%)
        }

        .hero h1 {
            font-family: 'JetBrains Mono', monospace;
            font-size: clamp(1.5rem, 4vw, 2.8rem);
            font-weight: 700;
            background: linear-gradient(135deg, var(--cy), var(--mg), var(--lm));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
            animation: glowPulse 3s ease-in-out infinite;
            letter-spacing: -0.5px
        }

        .hero .subtitle {
            font-family: 'Fira Code', monospace;
            color: var(--t2);
            font-size: .95rem;
            margin-bottom: 8px
        }

        .terminal-line {
            font-family: 'Fira Code', monospace;
            color: var(--lm);
            font-size: .85rem;
            opacity: 0;
            animation: typeIn .5s ease .3s forwards
        }

        .terminal-line::before {
            content: '$ ';
            color: var(--cy)
        }

        @keyframes typeIn {
            from {
                opacity: 0;
                transform: translateY(10px)
            }

            to {
                opacity: 1;
                transform: translateY(0)
            }
        }

        @keyframes glowPulse {

            0%,
            100% {
                filter: drop-shadow(0 0 8px rgba(0, 255, 255, 0.3))
            }

            50% {
                filter: drop-shadow(0 0 16px rgba(255, 0, 255, 0.4))
            }
        }

        .search-container {
            max-width: 700px;
            margin: 20px auto 25px;
            position: relative;
            z-index: 100;
            padding: 0 20px
        }

        #search-box {
            width: 100%;
            padding: 14px 50px 14px 45px;
            background: var(--card);
            border: 1px solid var(--bdr);
            border-radius: 12px;
            color: var(--t1);
            font-family: 'Fira Code', monospace;
            font-size: .9rem;
            outline: none;
            transition: var(--tr);
            backdrop-filter: blur(10px)
        }

        #search-box:focus {
            border-color: var(--cy);
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.15), inset 0 0 20px rgba(0, 255, 255, 0.05)
        }

        #search-box::placeholder {
            color: var(--t3)
        }

        .search-icon {
            position: absolute;
            left: 35px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--cy);
            font-size: 1.1rem;
            pointer-events: none
        }

        .search-shortcut {
            position: absolute;
            right: 35px;
            top: 50%;
            transform: translateY(-50%);
            background: var(--bg2);
            border: 1px solid var(--bdr);
            border-radius: 5px;
            padding: 2px 8px;
            font-family: 'Fira Code', monospace;
            font-size: .7rem;
            color: var(--t3);
            pointer-events: none
        }

        .search-results-count {
            text-align: center;
            color: var(--t3);
            font-size: .8rem;
            margin-top: 8px;
            font-family: 'Fira Code', monospace
        }

        .line-highlight {
            background: rgba(255, 221, 0, 0.18) !important;
            border-left: 3px solid rgba(255, 221, 0, 0.75) !important;
            padding-left: 8px !important;
            border-radius: 0 4px 4px 0
        }

        .line-highlight.line-highlight-active {
            background: rgba(255, 221, 0, 0.42) !important;
            border-left-color: #ffdd00 !important;
            box-shadow: 0 0 8px rgba(255, 221, 0, 0.35)
        }

        pre .line-highlight {
            display: block;
            background: rgba(255, 221, 0, 0.15);
            border-left: 3px solid rgba(255, 221, 0, 0.75);
            padding-left: 5px;
            margin-left: -5px;
            border-radius: 0 3px 3px 0
        }

        pre .line-highlight.line-highlight-active {
            background: rgba(255, 221, 0, 0.38);
            border-left-color: #ffdd00;
            box-shadow: 0 0 6px rgba(255, 221, 0, 0.35)
        }

        .light-mode .line-highlight {
            background: rgba(230, 160, 0, 0.22) !important;
            border-left-color: rgba(200, 130, 0, 0.85) !important
        }

        .light-mode .line-highlight.line-highlight-active {
            background: rgba(230, 160, 0, 0.5) !important;
            border-left-color: #c88000 !important
        }

        .light-mode pre .line-highlight {
            background: rgba(230, 160, 0, 0.18);
            border-left-color: rgba(200, 130, 0, 0.85)
        }

        .search-nav {
            display: none;
            position: fixed;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            z-index: 9999;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            background: var(--card);
            border: 1px solid var(--bdr);
            border-radius: 12px;
            padding: 12px 10px;
            backdrop-filter: blur(12px);
            box-shadow: 0 4px 24px rgba(0,0,0,0.4), 0 0 16px rgba(0,255,255,0.08)
        }

        .search-nav.visible { display: flex }

        .search-nav-btn {
            background: var(--bg2);
            border: 1px solid var(--bdr);
            border-radius: 8px;
            color: var(--cy);
            font-family: 'Fira Code', monospace;
            font-size: .8rem;
            padding: 7px 14px;
            cursor: pointer;
            transition: var(--tr);
            user-select: none;
            width: 100%;
            text-align: center
        }

        .search-nav-btn:hover {
            border-color: var(--cy);
            background: var(--card-h);
            box-shadow: 0 0 10px rgba(0,255,255,0.18)
        }

        .search-nav-btn:disabled {
            opacity: 0.35;
            cursor: not-allowed;
            box-shadow: none
        }

        .search-nav-label {
            color: var(--cy);
            font-family: 'Fira Code', monospace;
            font-size: .85rem;
            font-weight: 600;
            text-align: center;
            padding: 2px 4px
        }

        .search-nav-title {
            color: var(--t3);
            font-family: 'Fira Code', monospace;
            font-size: .7rem;
            text-align: center;
            letter-spacing: .05em;
            text-transform: uppercase
        }

        .toolbar {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            padding: 10px 20px;
            flex-wrap: wrap;
            position: relative;
            z-index: 1
        }

        .toolbar button {
            background: var(--card);
            border: 1px solid var(--bdr);
            border-radius: 8px;
            padding: 8px 16px;
            color: var(--t2);
            font-family: 'Fira Code', monospace;
            font-size: .78rem;
            cursor: pointer;
            transition: var(--tr);
            backdrop-filter: blur(10px)
        }

        .toolbar button:hover {
            border-color: var(--cy);
            color: var(--cy);
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.1)
        }

        .theme-toggle {
            font-size: 1.3rem !important;
            padding: 6px 10px !important
        }

        .nav-tabs-container {
            position: sticky;
            top: 3px;
            z-index: 999;
            background: var(--bg);
            border-bottom: 1px solid var(--bdr);
            padding: 10px 0;
            backdrop-filter: blur(20px)
        }

        .nav-tabs {
            display: flex;
            gap: 6px;
            overflow-x: auto;
            padding: 0 20px;
            scrollbar-width: none;
            max-width: 1400px;
            margin: 0 auto
        }

        .nav-tabs::-webkit-scrollbar {
            display: none
        }

        .nav-tab {
            flex-shrink: 0;
            background: var(--card);
            border: 1px solid var(--bdr);
            border-radius: 8px;
            padding: 8px 14px;
            color: var(--t2);
            font-family: 'Fira Code', monospace;
            font-size: .72rem;
            cursor: pointer;
            transition: var(--tr);
            white-space: nowrap;
            backdrop-filter: blur(10px)
        }

        .nav-tab:hover,
        .nav-tab.active {
            border-color: var(--cy);
            color: var(--cy);
            background: rgba(0, 255, 255, 0.05);
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.1)
        }

        .nav-tab.active {
            background: rgba(0, 255, 255, 0.1)
        }

        .main-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 1
        }

        .content-section {
            margin-bottom: 30px;
            scroll-margin-top: 60px
        }

        .section-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 15px;
            cursor: pointer;
            padding: 15px 20px;
            background: var(--card);
            border: 1px solid var(--bdr);
            border-radius: 12px;
            transition: var(--tr);
            user-select: none
        }

        .section-header:hover {
            border-color: var(--cy);
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.1)
        }

        .section-header h1 {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.3rem;
            font-weight: 600;
            background: linear-gradient(135deg, var(--cy), var(--mg));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            flex: 1;
            margin: 0
        }

        .section-toggle {
            color: var(--cy);
            font-size: 1.2rem;
            transition: transform .3s ease
        }

        .section-toggle.collapsed {
            transform: rotate(-90deg)
        }

        .section-body {
            overflow: hidden;
            transition: max-height .5s cubic-bezier(0.4, 0, 0.2, 1), opacity .3s ease
        }

        .section-body.collapsed {
            max-height: 0 !important;
            opacity: 0;
            pointer-events: none
        }

        .fav-btn {
            cursor: pointer;
            font-size: 1.1rem;
            transition: var(--tr);
            filter: grayscale(1) opacity(0.4)
        }

        .fav-btn.active {
            filter: grayscale(0) opacity(1)
        }

        .fav-btn:hover {
            transform: scale(1.2)
        }

        .card {
            background: var(--card);
            border: 1px solid var(--bdr);
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 20px;
            transition: var(--tr);
            backdrop-filter: blur(10px);
            position: relative;
            overflow: hidden
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 2px;
            background: linear-gradient(90deg, transparent, var(--cy), var(--mg), transparent);
            opacity: 0;
            transition: opacity .3s ease
        }

        .card:hover {
            border-color: var(--bdr-h);
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.1);
            transform: translateY(-2px)
        }

        .card:hover::before {
            opacity: 1
        }

        h2 {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.15rem;
            font-weight: 600;
            color: var(--cy);
            margin: 25px 0 15px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--bdr)
        }

        h3 {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1rem;
            font-weight: 500;
            color: var(--mg);
            margin: 20px 0 12px
        }

        p {
            margin: 10px 0;
            color: var(--t1)
        }

        strong {
            color: var(--cy);
            font-weight: 600
        }

        a {
            color: var(--cy);
            text-decoration: none;
            border-bottom: 1px solid transparent;
            transition: var(--tr)
        }

        a:hover {
            border-bottom-color: var(--cy);
            text-shadow: 0 0 8px rgba(0, 255, 255, 0.3)
        }

        ul,
        ol {
            margin: 10px 0 10px 20px;
            color: var(--t1)
        }

        li {
            margin: 5px 0;
            padding-left: 5px
        }

        li::marker {
            color: var(--cy)
        }

        blockquote {
            border-left: 3px solid var(--mg);
            padding: 12px 16px;
            margin: 15px 0;
            background: rgba(255, 0, 255, 0.05);
            border-radius: 0 8px 8px 0;
            font-style: italic
        }

        hr {
            border: none;
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--bdr), transparent);
            margin: 30px 0
        }

        pre {
            position: relative;
            margin: 15px 0;
            border-radius: 10px;
            overflow: visible
        }

        pre code {
            display: block;
            padding: 18px 20px;
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.5), rgba(10, 10, 30, 0.8));
            border: 1px solid var(--bdr);
            border-radius: 10px;
            font-family: 'Fira Code', 'JetBrains Mono', monospace;
            font-size: .82rem;
            line-height: 1.6;
            color: var(--t1);
            overflow-x: auto;
            white-space: pre;
            scrollbar-width: thin
        }

        .light-mode pre code {
            background: linear-gradient(135deg, rgba(240, 240, 250, 0.9), rgba(230, 230, 245, 0.9))
        }

        code {
            font-family: 'Fira Code', 'JetBrains Mono', monospace;
            background: var(--codebg);
            padding: 2px 7px;
            border-radius: 4px;
            font-size: .85em;
            color: var(--lm);
            border: 1px solid rgba(0, 255, 136, 0.1)
        }

        pre code code {
            background: none;
            border: none;
            padding: 0
        }

        .copy-btn {
            position: absolute;
            top: 8px;
            right: 8px;
            background: rgba(0, 255, 255, 0.1);
            border: 1px solid rgba(0, 255, 255, 0.2);
            border-radius: 6px;
            padding: 5px 10px;
            color: var(--cy);
            cursor: pointer;
            font-family: 'Fira Code', monospace;
            font-size: .7rem;
            transition: var(--tr);
            z-index: 10;
            opacity: 0
        }

        pre:hover .copy-btn {
            opacity: 1
        }

        .copy-btn:hover {
            background: rgba(0, 255, 255, 0.2);
            border-color: var(--cy)
        }

        .copy-btn.copied {
            background: rgba(0, 255, 136, 0.2);
            border-color: var(--lm);
            color: var(--lm)
        }

        table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            margin: 15px 0;
            border: 1px solid var(--bdr);
            border-radius: 10px;
            overflow: hidden;
            font-size: .85rem
        }

        thead {
            background: linear-gradient(135deg, rgba(0, 255, 255, 0.08), rgba(255, 0, 255, 0.05))
        }

        th {
            padding: 12px 15px;
            text-align: left;
            font-family: 'JetBrains Mono', monospace;
            font-weight: 600;
            color: var(--cy);
            border-bottom: 1px solid var(--bdr);
            font-size: .8rem;
            text-transform: uppercase;
            letter-spacing: .5px
        }

        td {
            padding: 10px 15px;
            border-bottom: 1px solid rgba(0, 255, 255, 0.05);
            transition: background .2s ease
        }

        tr:last-child td {
            border-bottom: none
        }

        tr:hover td {
            background: rgba(0, 255, 255, 0.03)
        }

        .toast {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: var(--card);
            border: 1px solid var(--lm);
            border-radius: 10px;
            padding: 12px 22px;
            color: var(--lm);
            font-family: 'Fira Code', monospace;
            font-size: .85rem;
            z-index: 10001;
            transform: translateY(100px);
            opacity: 0;
            transition: all .4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 0 20px rgba(0, 255, 136, 0.2);
            backdrop-filter: blur(10px)
        }

        .toast.show {
            transform: translateY(0);
            opacity: 1
        }

        .kbd-hint {
            position: fixed;
            bottom: 15px;
            left: 15px;
            font-family: 'Fira Code', monospace;
            font-size: .7rem;
            color: var(--t3);
            z-index: 100;
            opacity: .5
        }

        #matrix-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 9999;
            pointer-events: none;
            opacity: 0;
            transition: opacity .5s ease
        }

        #matrix-canvas.active {
            opacity: .7;
            pointer-events: auto
        }

        .fade-in {
            opacity: 0;
            transform: translateY(20px);
            transition: opacity .6s ease, transform .6s ease
        }

        .fade-in.visible {
            opacity: 1;
            transform: translateY(0)
        }

        @media(max-width:768px) {
            .hero h1 {
                font-size: 1.4rem
            }

            .card {
                padding: 16px
            }

            .nav-tab {
                padding: 6px 10px;
                font-size: .68rem
            }

            .main-container {
                padding: 10px
            }

            table {
                font-size: .75rem
            }

            th,
            td {
                padding: 8px 10px
            }

            .toolbar {
                gap: 6px
            }

            .toolbar button {
                padding: 6px 10px;
                font-size: .72rem
            }
        }

        @media(max-width:480px) {
            .hero {
                padding: 40px 15px 25px
            }

            .search-container {
                padding: 0 10px
            }

            pre code {
                font-size: .75rem;
                padding: 14px
            }
        }

        @media print {
            body {
                background: #fff;
                color: #000
            }

            .bg-grid,
            .hero,
            .nav-tabs-container,
            .toolbar,
            .search-container,
            .copy-btn,
            #progress-bar,
            .theme-toggle,
            .fav-btn,
            .kbd-hint,
            #matrix-canvas,
            .section-toggle {
                display: none !important
            }

            .card {
                border: 1px solid #ccc;
                break-inside: avoid;
                box-shadow: none;
                background: #fff
            }

            .section-body {
                max-height: none !important;
                opacity: 1 !important
            }

            .section-header {
                background: #f5f5f5
            }

            pre code {
                background: #f5f5f5;
                border: 1px solid #ddd;
                color: #333
            }

            code {
                background: #f0f0f0;
                color: #333
            }

            h1,
            h2,
            h3 {
                color: #333;
                -webkit-text-fill-color: #333;
                background: none
            }

            table {
                border: 1px solid #ccc
            }

            th {
                background: #eee;
                color: #333
            }

            td {
                border-bottom: 1px solid #eee
            }

            a {
                color: #333
            }

            strong {
                color: #333
            }
        }

        /* ========== SIGNATURE FOOTER STYLES ========== */
        /* ========== SIGNATURE FOOTER STYLES ========== */
        .signature-footer {
            background: var(--bg2);
            border-top: 1px solid var(--bdr);
            padding: 40px 20px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .signature-footer::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--cy), var(--mg), var(--cy), transparent);
            opacity: 0.5;
        }

        .copyright-text {
            font-family: 'Fira Code', monospace;
            font-size: 12px;
            color: var(--t3);
            margin-bottom: 20px;
            letter-spacing: 2px;
        }

        .signature-wrapper {
            position: relative;
            cursor: pointer;
            padding: 20px 40px;
            display: inline-block;
            border-radius: 8px;
            background: var(--card);
            border: 1px solid var(--bdr);
            transition: var(--tr);
        }

        .signature-wrapper:hover {
            background: var(--card-h);
            border-color: var(--bdr-h);
            box-shadow:
                0 0 20px rgba(0, 255, 255, 0.1),
                0 0 40px rgba(255, 0, 255, 0.05);
        }

        /* ========== IDLE STATE ANIMATION ========== */
        .signature-svg {
            filter: drop-shadow(0 0 6px var(--cy));
            animation: idle-glow 3s ease-in-out infinite alternate;
            transition: filter 0.3s ease;
        }

        .signature-wrapper:hover .signature-svg {
            filter: drop-shadow(0 0 12px var(--cy)) drop-shadow(0 0 25px var(--mg));
        }

        @keyframes idle-glow {
            0% {
                filter: drop-shadow(0 0 4px var(--cy)) drop-shadow(0 0 8px var(--cy2));
                transform: translateY(0);
            }

            100% {
                filter: drop-shadow(0 0 8px var(--mg)) drop-shadow(0 0 16px var(--mg2));
                transform: translateY(-2px);
            }
        }

        /* ========== SIGNATURE PATH STYLES ========== */
        .signature-path {
            fill: none;
            stroke: url(#sig-gradient);
            stroke-width: 2.5;
            stroke-linecap: round;
            stroke-linejoin: round;
        }

        .signature-path.idle {
            stroke-dasharray: 2000;
            stroke-dashoffset: 0;
            animation: idle-flow 12s linear infinite;
        }

        @keyframes idle-flow {
            0% {
                stroke-dashoffset: 0;
            }

            100% {
                stroke-dashoffset: -100;
            }
        }

        /* ========== HANDWRITING ANIMATION ========== */
        .signature-path.drawing {
            stroke-dasharray: 2000;
            stroke-dashoffset: 2000;
            animation: draw-sig 4s cubic-bezier(0.4, 0, 0.2, 1) forwards;
        }

        @keyframes draw-sig {
            to {
                stroke-dashoffset: 0;
            }
        }

        /* ========== UNDERLINE FLOURISH ========== */
        .flourish-path {
            fill: none;
            stroke: var(--mg);
            stroke-width: 2;
            stroke-linecap: round;
            opacity: 0.8;
        }

        .flourish-path.idle {
            stroke-dasharray: 500;
            stroke-dashoffset: 0;
        }

        .flourish-path.drawing {
            stroke-dasharray: 500;
            stroke-dashoffset: 500;
            animation: draw-flourish 1s ease forwards 3.8s;
        }

        @keyframes draw-flourish {
            to {
                stroke-dashoffset: 0;
            }
        }

        /* ========== PEN CURSOR ========== */
        .pen-cursor {
            position: absolute;
            font-size: 18px;
            opacity: 0;
            pointer-events: none;
            filter: drop-shadow(0 0 5px var(--cy));
            z-index: 10;
        }

        .pen-cursor.active {
            opacity: 1;
            animation: pen-trace 4s cubic-bezier(0.4, 0, 0.2, 1) forwards;
        }

        @keyframes pen-trace {
            0% {
                left: 2%;
                top: 45%;
                opacity: 1;
            }

            10% {
                left: 12%;
                top: 40%;
            }

            20% {
                left: 22%;
                top: 35%;
            }

            30% {
                left: 35%;
                top: 45%;
            }

            40% {
                left: 48%;
                top: 38%;
            }

            50% {
                left: 58%;
                top: 42%;
            }

            60% {
                left: 68%;
                top: 40%;
            }

            70% {
                left: 78%;
                top: 45%;
            }

            80% {
                left: 88%;
                top: 42%;
            }

            90% {
                left: 95%;
                top: 40%;
            }

            100% {
                left: 98%;
                top: 45%;
                opacity: 0;
            }
        }

        /* ========== INK PARTICLES ========== */
        .ink-particle {
            position: absolute;
            width: 3px;
            height: 3px;
            border-radius: 50%;
            pointer-events: none;
            opacity: 0;
        }

        .ink-particle.active {
            animation: ink-splash 0.8s ease-out forwards;
        }

        @keyframes ink-splash {
            0% {
                opacity: 1;
                transform: scale(0) translate(0, 0);
            }

            100% {
                opacity: 0;
                transform: scale(1) translate(var(--tx), var(--ty));
            }
        }

        /* ========== SPARKLES ========== */
        .sig-sparkle {
            position: absolute;
            width: 6px;
            height: 6px;
            background: radial-gradient(circle, var(--cy) 0%, transparent 70%);
            border-radius: 50%;
            pointer-events: none;
            opacity: 0;
        }

        .signature-wrapper:hover .sig-sparkle {
            animation: sparkle-pop 2s ease-in-out infinite;
        }

        .sig-sparkle:nth-child(1) {
            left: 5%;
            top: 30%;
            animation-delay: 0s;
        }

        .sig-sparkle:nth-child(2) {
            left: 25%;
            top: 65%;
            animation-delay: 0.3s;
        }

        .sig-sparkle:nth-child(3) {
            left: 50%;
            top: 25%;
            animation-delay: 0.6s;
        }

        .sig-sparkle:nth-child(4) {
            left: 75%;
            top: 60%;
            animation-delay: 0.9s;
        }

        .sig-sparkle:nth-child(5) {
            left: 95%;
            top: 35%;
            animation-delay: 1.2s;
        }

        @keyframes sparkle-pop {

            0%,
            100% {
                opacity: 0;
                transform: scale(0);
            }

            50% {
                opacity: 1;
                transform: scale(1.2);
            }
        }

        /* ========== CLICK HINT ========== */
        .click-hint {
            font-family: 'Fira Code', monospace;
            font-size: 10px;
            color: var(--t3);
            margin-top: 15px;
            letter-spacing: 1px;
            animation: hint-blink 2.5s ease-in-out infinite;
        }

        @keyframes hint-blink {

            0%,
            100% {
                opacity: 0.4;
            }

            50% {
                opacity: 0.8;
            }
        }

        .click-hint.hidden {
            opacity: 0 !important;
            transition: opacity 0.3s;
        }

        .click-hint span {
            color: var(--cy);
        }

        /* ========== HEX BADGE ========== */
        .hex-badge {
            font-family: 'Fira Code', monospace;
            font-size: 10px;
            color: var(--lm);
            background: rgba(0, 255, 136, 0.1);
            padding: 2px 8px;
            border-radius: 3px;
            margin-left: 10px;
            border: 1px solid rgba(0, 255, 136, 0.2);
        }
    </style>
</head>

<body>
    <div id="progress-bar"></div>
    <div class="bg-grid"></div>
    <canvas id="matrix-canvas"></canvas>
    <div class="hero">
        <h1>&#128269; Windows Digital Forensics CTF Cheat Sheet</h1>
        <div class="subtitle">Comprehensive Quick Reference Guide</div>
        <div class="terminal-line">forensics --mode=cheatsheet --theme=cyber</div>
    </div>
    <div class="search-container">
        <span class="search-icon">&#128269;</span>
        <input type="text" id="search-box" placeholder="Search commands, paths, tools..." autocomplete="off">
        <span class="search-shortcut">Ctrl+K</span>
        <div class="search-results-count" id="search-count"></div>
    </div>
    <div class="toolbar">
        <button onclick="toggleAllSections(true)">&#128194; Expand All</button>
        <button onclick="toggleAllSections(false)">&#128193; Collapse All</button>
        <button onclick="showFavorites()">&#11088; Favorites</button>
        <button class="theme-toggle" onclick="toggleTheme()" id="theme-btn">&#127769;</button>
    </div>
    <div class="nav-tabs-container">
        <div class="nav-tabs" id="nav-tabs">
            <button class="nav-tab" data-section="quick-reference-tables"
                onclick="scrollToSection('quick-reference-tables')">&#127919; Quick Reference</button>
            <button class="nav-tab" data-section="essential-tools-commands"
                onclick="scrollToSection('essential-tools-commands')">&#128736;&#65039; Essential Tools</button>
            <button class="nav-tab" data-section="registry-analysis"
                onclick="scrollToSection('registry-analysis')">&#128221; Registry Analysis</button>
            <button class="nav-tab" data-section="event-log-analysis"
                onclick="scrollToSection('event-log-analysis')">&#128202; Event Log Analysis</button>
            <button class="nav-tab" data-section="file-system-artifacts"
                onclick="scrollToSection('file-system-artifacts')">&#128190; File System Artifacts</button>
            <button class="nav-tab" data-section="user-activity-analysis"
                onclick="scrollToSection('user-activity-analysis')">&#128100; User Activity</button>
            <button class="nav-tab" data-section="persistence-mechanisms"
                onclick="scrollToSection('persistence-mechanisms')">&#128260; Persistence</button>
            <button class="nav-tab" data-section="malware-indicators"
                onclick="scrollToSection('malware-indicators')">&#129440; Malware Indicators</button>
        </div>
    </div>
    <div class="toast" id="toast"></div>
    <div class="kbd-hint">Ctrl+K: Search | Konami Code: Matrix Rain</div>
    <div class="main-container" id="main-content">
        <h1>üéØ Quick Reference Tables</h1>
        <h2>High-Value Artifacts by Investigation Type</h2>
        <table>
            <thead>
                <tr>
                    <th>Investigation Goal</th>
                    <th>Primary Artifacts</th>
                    <th>Tools</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>Program Execution</strong></td>
                    <td>Prefetch, AmCache, ShimCache, BAM/DAM, SRUM</td>
                    <td>PECmd, AmcacheParser, AppCompatCacheParser, SrumECmd</td>
                </tr>
                <tr>
                    <td><strong>File/Folder Access</strong></td>
                    <td>ShellBags, Jump Lists, LNK Files, Recent Files</td>
                    <td>SBECmd, JLECmd, LECmd</td>
                </tr>
                <tr>
                    <td><strong>User Activity</strong></td>
                    <td>NTUSER.DAT, UsrClass.dat, BAM, UserAssist</td>
                    <td>Registry Explorer, RegRipper</td>
                </tr>
                <tr>
                    <td><strong>Persistence</strong></td>
                    <td>Run Keys, Services, Scheduled Tasks, WMI</td>
                    <td>RECmd, Autoruns, Registry Explorer</td>
                </tr>
                <tr>
                    <td><strong>Lateral Movement</strong></td>
                    <td>Event Logs (4624, 4648), RDP Cache, PSExec</td>
                    <td>EvtxECmd, Chainsaw, Hayabusa</td>
                </tr>
                <tr>
                    <td><strong>Data Exfiltration</strong></td>
                    <td>SRUM, USB History, Cloud Storage, Browser</td>
                    <td>SrumECmd, USBDeview, Hindsight</td>
                </tr>
                <tr>
                    <td><strong>Malware Analysis</strong></td>
                    <td>Prefetch, MFT, $J (USN), Memory</td>
                    <td>MFTECmd, Volatility, PECmd</td>
                </tr>
                <tr>
                    <td><strong>Timeline Creation</strong></td>
                    <td>All of the above</td>
                    <td>KAPE, Plaso, Timeline Explorer</td>
                </tr>
            </tbody>
        </table>
        <h2>Critical File Locations Quick Reference</h2>
        <pre><code>üìÅ SYSTEM HIVE
C:\Windows\System32\config\SYSTEM

üìÅ SOFTWARE HIVE  
C:\Windows\System32\config\SOFTWARE

üìÅ SAM HIVE
C:\Windows\System32\config\SAM

üìÅ SECURITY HIVE
C:\Windows\System32\config\SECURITY

üìÅ USER REGISTRY (per user)
C:\Users\&lt;username&gt;\NTUSER.DAT
C:\Users\&lt;username&gt;\AppData\Local\Microsoft\Windows\UsrClass.dat

üìÅ EVENT LOGS
C:\Windows\System32\winevt\Logs\

üìÅ PREFETCH
C:\Windows\Prefetch\

üìÅ AMCACHE
C:\Windows\AppCompat\Programs\Amcache.hve

üìÅ SRUM
C:\Windows\System32\sru\SRUDB.dat

üìÅ $MFT
C:\$MFT (root of NTFS volume)

üìÅ $J (USN Journal)
C:\$Extend\$UsnJrnl:$J

üìÅ JUMP LISTS
C:\Users\&lt;user&gt;\AppData\Roaming\Microsoft\Windows\Recent\AutomaticDestinations\
C:\Users\&lt;user&gt;\AppData\Roaming\Microsoft\Windows\Recent\CustomDestinations\

üìÅ LNK FILES
C:\Users\&lt;user&gt;\AppData\Roaming\Microsoft\Windows\Recent\

üìÅ SHELLBAGS
NTUSER.DAT: Software\Microsoft\Windows\Shell\Bags
UsrClass.dat: Local Settings\Software\Microsoft\Windows\Shell\Bags

üìÅ BROWSER DATA
Chrome: C:\Users\&lt;user&gt;\AppData\Local\Google\Chrome\User Data\Default\
Firefox: C:\Users\&lt;user&gt;\AppData\Roaming\Mozilla\Firefox\Profiles\
Edge: C:\Users\&lt;user&gt;\AppData\Local\Microsoft\Edge\User Data\Default\
</code></pre>
        <h2>Important Event IDs Quick Reference</h2>
        <table>
            <thead>
                <tr>
                    <th>Event ID</th>
                    <th>Log</th>
                    <th>Description</th>
                    <th>CTF Relevance</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>4624</strong></td>
                    <td>Security</td>
                    <td>Successful Logon</td>
                    <td>Login analysis, lateral movement</td>
                </tr>
                <tr>
                    <td><strong>4625</strong></td>
                    <td>Security</td>
                    <td>Failed Logon</td>
                    <td>Brute force detection</td>
                </tr>
                <tr>
                    <td><strong>4648</strong></td>
                    <td>Security</td>
                    <td>Explicit Credential Logon</td>
                    <td>Credential use, runas</td>
                </tr>
                <tr>
                    <td><strong>4672</strong></td>
                    <td>Security</td>
                    <td>Special Privileges Assigned</td>
                    <td>Admin activity</td>
                </tr>
                <tr>
                    <td><strong>4688</strong></td>
                    <td>Security</td>
                    <td>Process Creation</td>
                    <td>Command execution (if enabled)</td>
                </tr>
                <tr>
                    <td><strong>4698</strong></td>
                    <td>Security</td>
                    <td>Scheduled Task Created</td>
                    <td>Persistence</td>
                </tr>
                <tr>
                    <td><strong>4699</strong></td>
                    <td>Security</td>
                    <td>Scheduled Task Deleted</td>
                    <td>Anti-forensics</td>
                </tr>
                <tr>
                    <td><strong>4702</strong></td>
                    <td>Security</td>
                    <td>Scheduled Task Updated</td>
                    <td>Persistence modification</td>
                </tr>
                <tr>
                    <td><strong>4720</strong></td>
                    <td>Security</td>
                    <td>User Account Created</td>
                    <td>Account creation</td>
                </tr>
                <tr>
                    <td><strong>4732</strong></td>
                    <td>Security</td>
                    <td>Member Added to Local Group</td>
                    <td>Privilege escalation</td>
                </tr>
                <tr>
                    <td><strong>4776</strong></td>
                    <td>Security</td>
                    <td>NTLM Authentication</td>
                    <td>Auth analysis</td>
                </tr>
                <tr>
                    <td><strong>7045</strong></td>
                    <td>System</td>
                    <td>Service Installed</td>
                    <td>Persistence, malware</td>
                </tr>
                <tr>
                    <td><strong>7040</strong></td>
                    <td>System</td>
                    <td>Service Start Type Changed</td>
                    <td>Service manipulation</td>
                </tr>
                <tr>
                    <td><strong>1</strong></td>
                    <td>Sysmon</td>
                    <td>Process Create</td>
                    <td>Detailed execution</td>
                </tr>
                <tr>
                    <td><strong>3</strong></td>
                    <td>Sysmon</td>
                    <td>Network Connection</td>
                    <td>C2 detection</td>
                </tr>
                <tr>
                    <td><strong>7</strong></td>
                    <td>Sysmon</td>
                    <td>Image Loaded</td>
                    <td>DLL analysis</td>
                </tr>
                <tr>
                    <td><strong>11</strong></td>
                    <td>Sysmon</td>
                    <td>File Create</td>
                    <td>File creation tracking</td>
                </tr>
                <tr>
                    <td><strong>13</strong></td>
                    <td>Sysmon</td>
                    <td>Registry Value Set</td>
                    <td>Registry monitoring</td>
                </tr>
                <tr>
                    <td><strong>22</strong></td>
                    <td>Sysmon</td>
                    <td>DNS Query</td>
                    <td>DNS analysis</td>
                </tr>
                <tr>
                    <td><strong>1102</strong></td>
                    <td>Security</td>
                    <td>Audit Log Cleared</td>
                    <td>Anti-forensics</td>
                </tr>
                <tr>
                    <td><strong>104</strong></td>
                    <td>System</td>
                    <td>Log Cleared</td>
                    <td>Anti-forensics</td>
                </tr>
                <tr>
                    <td><strong>4104</strong></td>
                    <td>PowerShell</td>
                    <td>Script Block Logging</td>
                    <td>PowerShell commands</td>
                </tr>
                <tr>
                    <td><strong>4103</strong></td>
                    <td>PowerShell</td>
                    <td>Module Logging</td>
                    <td>PowerShell activity</td>
                </tr>
                <tr>
                    <td><strong>400/403</strong></td>
                    <td>PowerShell</td>
                    <td>Engine Start/Stop</td>
                    <td>PowerShell sessions</td>
                </tr>
            </tbody>
        </table>
        <h2>Logon Type Reference</h2>
        <table>
            <thead>
                <tr>
                    <th>Type</th>
                    <th>Description</th>
                    <th>Common Use</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>2</strong></td>
                    <td>Interactive (Console)</td>
                    <td>Physical/local logon</td>
                </tr>
                <tr>
                    <td><strong>3</strong></td>
                    <td>Network</td>
                    <td>SMB, net use, PsExec (network)</td>
                </tr>
                <tr>
                    <td><strong>4</strong></td>
                    <td>Batch</td>
                    <td>Scheduled tasks</td>
                </tr>
                <tr>
                    <td><strong>5</strong></td>
                    <td>Service</td>
                    <td>Service account logon</td>
                </tr>
                <tr>
                    <td><strong>7</strong></td>
                    <td>Unlock</td>
                    <td>Workstation unlock</td>
                </tr>
                <tr>
                    <td><strong>8</strong></td>
                    <td>NetworkCleartext</td>
                    <td>IIS Basic Auth</td>
                </tr>
                <tr>
                    <td><strong>9</strong></td>
                    <td>NewCredentials</td>
                    <td>RunAs /netonly</td>
                </tr>
                <tr>
                    <td><strong>10</strong></td>
                    <td>RemoteInteractive</td>
                    <td>RDP, Terminal Services</td>
                </tr>
                <tr>
                    <td><strong>11</strong></td>
                    <td>CachedInteractive</td>
                    <td>Cached domain credentials</td>
                </tr>
            </tbody>
        </table>
        <hr />
        <h1>üõ†Ô∏è Essential Tools &amp; Commands</h1>
        <h2>Eric Zimmerman Tools</h2>
        <blockquote>
            <p><strong>Download</strong>: https://ericzimmerman.github.io/#!index.md<br />
                <strong>Update Command</strong>: <code>.\Get-ZimmermanTools.ps1 -Dest C:\Tools\EZ</code>
            </p>
        </blockquote>
        <h3>MFTECmd - Master File Table Parser</h3>
        <p><strong>Purpose</strong>: Parse NTFS $MFT for file system metadata, timestamps, and deleted files</p>
        <p><strong>CTF Use Cases</strong>:</p>
        <ul>
            <li>Find deleted files and their original timestamps</li>
            <li>Identify anti-forensic timestamp manipulation (timestomping)</li>
            <li>Track file creation in suspicious locations</li>
            <li>Recover file paths and parent directories</li>
        </ul>
        <p><strong>Key Commands</strong>:</p>
        <pre><code class="language-powershell"># Parse $MFT to CSV
MFTECmd.exe -f "C:\$MFT" --csv C:\output --csvf mft_output.csv

# Parse $MFT with body file output (for timeline)
MFTECmd.exe -f "C:\$MFT" --body C:\output --bodyf mft_body.txt --bdl C:

# Parse $J (USN Journal)
MFTECmd.exe -f "C:\$Extend\$UsnJrnl:$J" --csv C:\output --csvf usn_output.csv

# Parse $Boot
MFTECmd.exe -f "C:\$Boot" --csv C:\output

# Parse $SDS (Security Descriptors)
MFTECmd.exe -f "C:\$Secure:$SDS" --csv C:\output
</code></pre>
        <p><strong>Key Output Fields</strong>:</p>
        <table>
            <thead>
                <tr>
                    <th>Field</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>EntryNumber</code></td>
                    <td>MFT record number</td>
                </tr>
                <tr>
                    <td><code>ParentPath</code></td>
                    <td>Full path to parent directory</td>
                </tr>
                <tr>
                    <td><code>FileName</code></td>
                    <td>File name</td>
                </tr>
                <tr>
                    <td><code>Created0x10</code></td>
                    <td>$STANDARD_INFORMATION Created timestamp</td>
                </tr>
                <tr>
                    <td><code>Created0x30</code></td>
                    <td>$FILE_NAME Created timestamp</td>
                </tr>
                <tr>
                    <td><code>InUse</code></td>
                    <td>Whether file is deleted (False = deleted)</td>
                </tr>
                <tr>
                    <td><code>IsDirectory</code></td>
                    <td>Directory flag</td>
                </tr>
                <tr>
                    <td><code>Extension</code></td>
                    <td>File extension</td>
                </tr>
                <tr>
                    <td><code>FileSize</code></td>
                    <td>Size in bytes</td>
                </tr>
            </tbody>
        </table>
        <p><strong>Timestomping Detection</strong>:</p>
        <pre><code>If Created0x10 &lt; Created0x30 ‚Üí Possible timestomping
$STANDARD_INFO timestamps can be modified; $FILE_NAME cannot (without special tools)
</code></pre>
        <hr />
        <h3>PECmd - Prefetch Parser</h3>
        <p><strong>Purpose</strong>: Parse Windows Prefetch files for program execution evidence</p>
        <p><strong>CTF Use Cases</strong>:</p>
        <ul>
            <li>Prove program execution</li>
            <li>Determine execution count and timestamps</li>
            <li>Identify files/directories accessed by executable</li>
            <li>Track malware execution</li>
        </ul>
        <p><strong>Key Commands</strong>:</p>
        <pre><code class="language-powershell"># Parse single prefetch file
PECmd.exe -f "C:\Windows\Prefetch\CMD.EXE-4A81B364.pf" --csv C:\output

# Parse entire Prefetch directory
PECmd.exe -d "C:\Windows\Prefetch" --csv C:\output --csvf prefetch_output.csv

# Parse with JSON output
PECmd.exe -d "C:\Windows\Prefetch" --json C:\output

# Parse with timeline (body file)
PECmd.exe -d "C:\Windows\Prefetch" -q --csv C:\output
</code></pre>
        <p><strong>Key Output Fields</strong>:</p>
        <table>
            <thead>
                <tr>
                    <th>Field</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>ExecutableName</code></td>
                    <td>Name of executed program</td>
                </tr>
                <tr>
                    <td><code>RunCount</code></td>
                    <td>Number of times executed</td>
                </tr>
                <tr>
                    <td><code>LastRun</code></td>
                    <td>Most recent execution time</td>
                </tr>
                <tr>
                    <td><code>PreviousRun0-6</code></td>
                    <td>Previous 7 execution times (Win8+)</td>
                </tr>
                <tr>
                    <td><code>FilesLoaded</code></td>
                    <td>Files accessed during execution</td>
                </tr>
                <tr>
                    <td><code>Directories</code></td>
                    <td>Directories accessed</td>
                </tr>
                <tr>
                    <td><code>Hash</code></td>
                    <td>Prefetch hash (path-based)</td>
                </tr>
            </tbody>
        </table>
        <p><strong>Important Notes</strong>:</p>
        <ul>
            <li>Windows 7: 1 timestamp, up to 128 prefetch files</li>
            <li>Windows 8+: 8 timestamps, up to 1024 prefetch files</li>
            <li>Prefetch file name format: <code>EXECUTABLE.EXE-HASH.pf</code></li>
            <li>Same exe from different paths = different hash</li>
        </ul>
        <hr />
        <h3>LECmd - LNK File Parser</h3>
        <p><strong>Purpose</strong>: Parse Windows shortcut (LNK) files for file access evidence</p>
        <p><strong>CTF Use Cases</strong>:</p>
        <ul>
            <li>Track accessed files and folders</li>
            <li>Identify files accessed from external drives</li>
            <li>Recover paths to deleted files</li>
            <li>Find evidence of USB device usage</li>
        </ul>
        <p><strong>Key Commands</strong>:</p>
        <pre><code class="language-powershell"># Parse single LNK file
LECmd.exe -f "C:\Users\user\Desktop\file.lnk" --csv C:\output

# Parse Recent folder
LECmd.exe -d "C:\Users\user\AppData\Roaming\Microsoft\Windows\Recent" --csv C:\output --csvf lnk_output.csv

# Parse with all details
LECmd.exe -d "C:\path" --csv C:\output --all

# Quiet mode (less verbose)
LECmd.exe -d "C:\path" -q --csv C:\output
</code></pre>
        <p><strong>Key Output Fields</strong>:</p>
        <table>
            <thead>
                <tr>
                    <th>Field</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>SourceFile</code></td>
                    <td>Path to LNK file</td>
                </tr>
                <tr>
                    <td><code>TargetIDAbsolutePath</code></td>
                    <td>Original target path</td>
                </tr>
                <tr>
                    <td><code>LocalPath</code></td>
                    <td>Local path to target</td>
                </tr>
                <tr>
                    <td><code>NetworkPath</code></td>
                    <td>Network path (if applicable)</td>
                </tr>
                <tr>
                    <td><code>DriveSerialNumber</code></td>
                    <td>Volume serial number</td>
                </tr>
                <tr>
                    <td><code>DriveType</code></td>
                    <td>Fixed, Removable, Network</td>
                </tr>
                <tr>
                    <td><code>VolumeLabel</code></td>
                    <td>Volume name</td>
                </tr>
                <tr>
                    <td><code>MachineID</code></td>
                    <td>NetBIOS name</td>
                </tr>
                <tr>
                    <td><code>TargetCreated</code></td>
                    <td>Target file creation time</td>
                </tr>
                <tr>
                    <td><code>TargetModified</code></td>
                    <td>Target file modification time</td>
                </tr>
                <tr>
                    <td><code>TargetAccessed</code></td>
                    <td>Target file access time</td>
                </tr>
            </tbody>
        </table>
        <hr />
        <h3>JLECmd - Jump List Parser</h3>
        <p><strong>Purpose</strong>: Parse Windows Jump Lists for recent file access evidence</p>
        <p><strong>CTF Use Cases</strong>:</p>
        <ul>
            <li>Track recently accessed files per application</li>
            <li>Identify files opened from specific applications</li>
            <li>Find evidence of deleted files</li>
            <li>Correlate application usage with file access</li>
        </ul>
        <p><strong>Key Commands</strong>:</p>
        <pre><code class="language-powershell"># Parse AutomaticDestinations
JLECmd.exe -d "C:\Users\user\AppData\Roaming\Microsoft\Windows\Recent\AutomaticDestinations" --csv C:\output --csvf auto_jl.csv

# Parse CustomDestinations
JLECmd.exe -d "C:\Users\user\AppData\Roaming\Microsoft\Windows\Recent\CustomDestinations" --csv C:\output --csvf custom_jl.csv

# Parse single file
JLECmd.exe -f "file.automaticDestinations-ms" --csv C:\output

# With all embedded LNK details
JLECmd.exe -d "C:\path" --csv C:\output --ld
</code></pre>
        <p><strong>Jump List App IDs</strong> (Common):</p>
        <table>
            <thead>
                <tr>
                    <th>AppID</th>
                    <th>Application</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>1b4dd67f29cb1962</code></td>
                    <td>Windows Explorer</td>
                </tr>
                <tr>
                    <td><code>5f7b5f1e01b83767</code></td>
                    <td>Notepad</td>
                </tr>
                <tr>
                    <td><code>9839aec31243a928</code></td>
                    <td>Notepad++</td>
                </tr>
                <tr>
                    <td><code>a7bd71699cd38d1c</code></td>
                    <td>Notepad (Win7)</td>
                </tr>
                <tr>
                    <td><code>7e4dca80246863e3</code></td>
                    <td>Control Panel</td>
                </tr>
                <tr>
                    <td><code>1bc392b8e104a00e</code></td>
                    <td>Remote Desktop</td>
                </tr>
                <tr>
                    <td><code>b8ab77100df80ab2</code></td>
                    <td>Chrome</td>
                </tr>
                <tr>
                    <td><code>9b9cdc69c1c24e2b</code></td>
                    <td>Thunderbird</td>
                </tr>
                <tr>
                    <td><code>5d696d521de238c3</code></td>
                    <td>Chrome (2)</td>
                </tr>
                <tr>
                    <td><code>28c8b86deab549a1</code></td>
                    <td>Internet Explorer</td>
                </tr>
                <tr>
                    <td><code>f01b4d95cf55d32a</code></td>
                    <td>Windows Explorer (Win7)</td>
                </tr>
                <tr>
                    <td><code>12dc1ea8e34b5a6</code></td>
                    <td>Paint</td>
                </tr>
            </tbody>
        </table>
        <p><strong>Jump List Location Decoder</strong>:</p>
        <pre><code>AutomaticDestinations: Created automatically by Windows
CustomDestinations: Created by applications (pinned items, custom recent)
</code></pre>
        <hr />
        <h3>SBECmd - ShellBags Explorer (CLI)</h3>
        <p><strong>Purpose</strong>: Parse ShellBags for folder access history (including deleted folders)</p>
        <p><strong>CTF Use Cases</strong>:</p>
        <ul>
            <li>Track folder access/browsing history</li>
            <li>Find evidence of accessed USB/removable drives</li>
            <li>Identify deleted folder access</li>
            <li>Prove user interaction with specific directories</li>
        </ul>
        <p><strong>Key Commands</strong>:</p>
        <pre><code class="language-powershell"># Parse UsrClass.dat
SBECmd.exe -d "C:\Users\user\AppData\Local\Microsoft\Windows" --csv C:\output

# Parse NTUSER.DAT
SBECmd.exe --hive "C:\Users\user\NTUSER.DAT" --csv C:\output

# Parse offline hive
SBECmd.exe --hive "D:\Evidence\UsrClass.dat" --csv C:\output --csvf shellbags.csv

# Live system (use with caution)
SBECmd.exe -l --csv C:\output
</code></pre>
        <p><strong>Key Output Fields</strong>:</p>
        <table>
            <thead>
                <tr>
                    <th>Field</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>AbsolutePath</code></td>
                    <td>Full folder path</td>
                </tr>
                <tr>
                    <td><code>ShellType</code></td>
                    <td>Type of shell item</td>
                </tr>
                <tr>
                    <td><code>CreatedOn</code></td>
                    <td>First access timestamp</td>
                </tr>
                <tr>
                    <td><code>ModifiedOn</code></td>
                    <td>Last modification</td>
                </tr>
                <tr>
                    <td><code>AccessedOn</code></td>
                    <td>Last access</td>
                </tr>
                <tr>
                    <td><code>LastInteracted</code></td>
                    <td>Last user interaction</td>
                </tr>
                <tr>
                    <td><code>MFTID</code></td>
                    <td>MFT entry (if available)</td>
                </tr>
            </tbody>
        </table>
        <hr />
        <h3>AmcacheParser - Amcache.hve Parser</h3>
        <p><strong>Purpose</strong>: Parse Amcache for program execution and installation evidence</p>
        <p><strong>CTF Use Cases</strong>:</p>
        <ul>
            <li>Track program execution (with SHA1 hashes!)</li>
            <li>Identify malware and associated files</li>
            <li>Find portable application execution</li>
            <li>Track installed programs</li>
        </ul>
        <p><strong>Key Commands</strong>:</p>
        <pre><code class="language-powershell"># Parse Amcache.hve
AmcacheParser.exe -f "C:\Windows\AppCompat\Programs\Amcache.hve" --csv C:\output --csvf amcache.csv

# Include NTFS metadata
AmcacheParser.exe -f "C:\Windows\AppCompat\Programs\Amcache.hve" --csv C:\output -i

# Parse with program entries
AmcacheParser.exe -f "Amcache.hve" --csv C:\output --csvf amcache.csv
</code></pre>
        <p><strong>Key Output Fields</strong>:</p>
        <table>
            <thead>
                <tr>
                    <th>Field</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>SHA1</code></td>
                    <td>File hash (very useful!)</td>
                </tr>
                <tr>
                    <td><code>FullPath</code></td>
                    <td>Path to executable</td>
                </tr>
                <tr>
                    <td><code>FileKeyLastWriteTimestamp</code></td>
                    <td>Last modification</td>
                </tr>
                <tr>
                    <td><code>CompanyName</code></td>
                    <td>Publisher</td>
                </tr>
                <tr>
                    <td><code>FileDescription</code></td>
                    <td>Description</td>
                </tr>
                <tr>
                    <td><code>FileVersion</code></td>
                    <td>Version</td>
                </tr>
                <tr>
                    <td><code>Publisher</code></td>
                    <td>Software publisher</td>
                </tr>
                <tr>
                    <td><code>InstallDate</code></td>
                    <td>Installation date</td>
                </tr>
            </tbody>
        </table>
        <p><strong>Important Notes</strong>:</p>
        <ul>
            <li>Contains SHA1 hashes - great for malware identification</li>
            <li>Persists even after file deletion</li>
            <li>Different keys for different Windows versions</li>
        </ul>
        <hr />
        <h3>AppCompatCacheParser - ShimCache Parser</h3>
        <p><strong>Purpose</strong>: Parse Application Compatibility Cache (ShimCache)</p>
        <p><strong>CTF Use Cases</strong>:</p>
        <ul>
            <li>Track program execution (no hash, but paths)</li>
            <li>Find evidence of deleted programs</li>
            <li>Identify malware in execution history</li>
            <li>Note: Execution is NOT guaranteed (just loaded)</li>
        </ul>
        <p><strong>Key Commands</strong>:</p>
        <pre><code class="language-powershell"># Parse SYSTEM hive
AppCompatCacheParser.exe -f "C:\Windows\System32\config\SYSTEM" --csv C:\output --csvf shimcache.csv

# Parse offline SYSTEM hive
AppCompatCacheParser.exe -f "D:\Evidence\SYSTEM" --csv C:\output

# With control set specification
AppCompatCacheParser.exe -f "SYSTEM" -c 1 --csv C:\output
</code></pre>
        <p><strong>Key Output Fields</strong>:</p>
        <table>
            <thead>
                <tr>
                    <th>Field</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>Path</code></td>
                    <td>Full executable path</td>
                </tr>
                <tr>
                    <td><code>LastModifiedTimeUTC</code></td>
                    <td>File modification time</td>
                </tr>
                <tr>
                    <td><code>Executed</code></td>
                    <td>Execution flag (Win7 and earlier only!)</td>
                </tr>
                <tr>
                    <td><code>CacheEntryPosition</code></td>
                    <td>Position in cache</td>
                </tr>
            </tbody>
        </table>
        <p><strong>Important Notes</strong>:</p>
        <ul>
            <li><strong>Windows 10+</strong>: Execution flag is NOT present - presence only indicates the file was
                accessed</li>
            <li>Entries are ordered by most recent activity (position 0 = most recent)</li>
            <li>Limit of ~1024 entries</li>
        </ul>
        <hr />
        <h3>SrumECmd - SRUM Database Parser</h3>
        <p><strong>Purpose</strong>: Parse System Resource Usage Monitor database</p>
        <p><strong>CTF Use Cases</strong>:</p>
        <ul>
            <li>Network usage by application</li>
            <li>Application resource usage</li>
            <li>Timeline of application activity</li>
            <li>Data exfiltration indicators</li>
        </ul>
        <p><strong>Key Commands</strong>:</p>
        <pre><code class="language-powershell"># Parse SRUDB.dat (requires SOFTWARE hive for SID resolution)
SrumECmd.exe -f "C:\Windows\System32\sru\SRUDB.dat" -r "C:\Windows\System32\config\SOFTWARE" --csv C:\output

# Parse without registry (less detail)
SrumECmd.exe -f "SRUDB.dat" --csv C:\output
</code></pre>
        <p><strong>Key Tables</strong>:</p>
        <table>
            <thead>
                <tr>
                    <th>Table</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>AppResourceUseInfo</code></td>
                    <td>Application resource usage</td>
                </tr>
                <tr>
                    <td><code>NetworkDataUsage</code></td>
                    <td>Network bytes sent/received per app</td>
                </tr>
                <tr>
                    <td><code>NetworkConnectivityData</code></td>
                    <td>Network connectivity info</td>
                </tr>
                <tr>
                    <td><code>AppTimeline</code></td>
                    <td>Application timeline</td>
                </tr>
                <tr>
                    <td><code>PushNotifications</code></td>
                    <td>Push notification data</td>
                </tr>
            </tbody>
        </table>
        <p><strong>High-Value Columns</strong>:</p>
        <ul>
            <li><code>BytesSent</code> / <code>BytesReceived</code> - Data transfer</li>
            <li><code>ExeInfo</code> - Executable path</li>
            <li><code>TimeStamp</code> - Activity time</li>
            <li><code>UserId</code> - Associated user SID</li>
        </ul>
        <hr />
        <h3>EvtxECmd - Event Log Parser</h3>
        <p><strong>Purpose</strong>: Parse Windows Event Logs (EVTX files)</p>
        <p><strong>CTF Use Cases</strong>:</p>
        <ul>
            <li>Security event analysis</li>
            <li>Timeline creation</li>
            <li>Specific event ID extraction</li>
            <li>Mass event log processing</li>
        </ul>
        <p><strong>Key Commands</strong>:</p>
        <pre><code class="language-powershell"># Parse single EVTX file
EvtxECmd.exe -f "C:\Windows\System32\winevt\Logs\Security.evtx" --csv C:\output --csvf security.csv

# Parse all logs in directory
EvtxECmd.exe -d "C:\Windows\System32\winevt\Logs" --csv C:\output --csvf all_logs.csv

# Parse with maps (enhanced parsing)
EvtxECmd.exe -f "Security.evtx" --csv C:\output --maps "C:\Tools\EvtxECmd\Maps"

# JSON output
EvtxECmd.exe -f "Security.evtx" --json C:\output

# Filter by date
EvtxECmd.exe -f "Security.evtx" --csv C:\output --sd "2024-01-01" --ed "2024-01-31"
</code></pre>
        <p><strong>Maps Usage</strong>:<br />
            Maps enhance event parsing - update regularly:</p>
        <pre><code class="language-powershell"># Update maps
.\Get-ZimmermanTools.ps1 -Dest C:\Tools\EZ
</code></pre>
        <hr />
        <h3>RECmd - Registry Command Line Parser</h3>
        <p><strong>Purpose</strong>: Command-line registry parser with batch processing</p>
        <p><strong>CTF Use Cases</strong>:</p>
        <ul>
            <li>Extract specific registry keys/values</li>
            <li>Batch processing of registry hives</li>
            <li>Custom regex searches</li>
            <li>Export to CSV/JSON</li>
        </ul>
        <p><strong>Key Commands</strong>:</p>
        <pre><code class="language-powershell"># Parse using batch file
RECmd.exe --bn "C:\Tools\RECmd\BatchExamples\Kroll_Batch.reb" -d "C:\Evidence\Registry" --csv C:\output

# Parse specific key
RECmd.exe -f "NTUSER.DAT" --kn "Software\Microsoft\Windows\CurrentVersion\Run" --csv C:\output

# Recursive key parse
RECmd.exe -f "SOFTWARE" --kn "Microsoft\Windows\CurrentVersion" -r --csv C:\output

# Search for value
RECmd.exe -f "NTUSER.DAT" --sv "password" --csv C:\output

# RegEx search
RECmd.exe -f "NTUSER.DAT" --sr ".*secret.*" --csv C:\output

# Base64 value search
RECmd.exe -f "NTUSER.DAT" --base64 --csv C:\output
</code></pre>
        <p><strong>Useful Batch Files</strong>:</p>
        <ul>
            <li><code>Kroll_Batch.reb</code> - Comprehensive forensic extraction</li>
            <li><code>BasicSystemInfo.reb</code> - System information</li>
            <li><code>UserActivity.reb</code> - User activity artifacts</li>
        </ul>
        <hr />
        <h3>Registry Explorer (GUI)</h3>
        <p><strong>Purpose</strong>: GUI-based registry analysis with advanced features</p>
        <p><strong>CTF Use Cases</strong>:</p>
        <ul>
            <li>Interactive registry browsing</li>
            <li>Deleted key recovery</li>
            <li>Timeline analysis</li>
            <li>Association with bookmarks</li>
        </ul>
        <p><strong>Key Features</strong>:</p>
        <ul>
            <li>Load multiple hives simultaneously</li>
            <li>View deleted keys/values (marked in red)</li>
            <li>Bookmark common forensic keys</li>
            <li>Export to various formats</li>
            <li>Technical details view</li>
        </ul>
        <p><strong>Navigation Shortcuts</strong>:</p>
        <table>
            <thead>
                <tr>
                    <th>Shortcut</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>Ctrl+G</code></td>
                    <td>Go to key path</td>
                </tr>
                <tr>
                    <td><code>Ctrl+F</code></td>
                    <td>Find</td>
                </tr>
                <tr>
                    <td><code>Ctrl+B</code></td>
                    <td>Bookmarks</td>
                </tr>
                <tr>
                    <td><code>Ctrl+T</code></td>
                    <td>Technical details</td>
                </tr>
            </tbody>
        </table>
        <hr />
        <h3>Timeline Explorer</h3>
        <p><strong>Purpose</strong>: View and filter CSV output from other tools</p>
        <p><strong>CTF Use Cases</strong>:</p>
        <ul>
            <li>Filter large CSV datasets</li>
            <li>Create timelines from multiple sources</li>
            <li>Quick searching and filtering</li>
            <li>Data visualization</li>
        </ul>
        <p><strong>Key Features</strong>:</p>
        <pre><code>- Open multiple CSVs as tabs
- Filter columns with expressions
- Group by columns
- Export filtered results
- Conditional formatting
- Column visibility control
</code></pre>
        <p><strong>Filter Syntax</strong>:</p>
        <pre><code># Contains
[ColumnName] like '%value%'

# Equals
[ColumnName] = 'value'

# Date range
[Timestamp] &gt;= '2024-01-01' AND [Timestamp] &lt;= '2024-01-31'

# Multiple conditions
[Column1] like '%exe%' AND [Column2] = 'True'

# Not contains
NOT [ColumnName] like '%value%'
</code></pre>
        <hr />
        <h2>KAPE (Kroll Artifact Parser and Extractor)</h2>
        <p><strong>Purpose</strong>: Automated collection and processing of forensic artifacts</p>
        <p><strong>CTF Use Cases</strong>:</p>
        <ul>
            <li>Rapid triage collection</li>
            <li>Batch processing of artifacts</li>
            <li>Consistent evidence collection</li>
            <li>Timeline creation</li>
        </ul>
        <p><strong>Key Commands</strong>:</p>
        <pre><code class="language-powershell"># Collection only (Targets)
kape.exe --tsource C: --tdest C:\Collection --target KapeTriage

# Processing only (Modules)
kape.exe --msource C:\Collection --mdest C:\Processed --module !EZParser

# Collection + Processing
kape.exe --tsource C: --tdest C:\Collection --target KapeTriage --mdest C:\Processed --module !EZParser

# Specific targets
kape.exe --tsource C: --tdest C:\Collection --target RegistryHives,EventLogs,Prefetch

# List available targets
kape.exe --tlist

# List available modules
kape.exe --mlist

# Flush (sync) frequently
kape.exe --tsource C: --tdest C:\Collection --target KapeTriage --sync
</code></pre>
        <p><strong>Common Targets</strong>:</p>
        <table>
            <thead>
                <tr>
                    <th>Target</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>KapeTriage</code></td>
                    <td>Comprehensive triage collection</td>
                </tr>
                <tr>
                    <td><code>RegistryHives</code></td>
                    <td>All registry hives</td>
                </tr>
                <tr>
                    <td><code>EventLogs</code></td>
                    <td>Windows Event Logs</td>
                </tr>
                <tr>
                    <td><code>Prefetch</code></td>
                    <td>Prefetch files</td>
                </tr>
                <tr>
                    <td><code>$MFT</code></td>
                    <td>Master File Table</td>
                </tr>
                <tr>
                    <td><code>Amcache</code></td>
                    <td>Amcache.hve</td>
                </tr>
                <tr>
                    <td><code>SRUM</code></td>
                    <td>SRUM database</td>
                </tr>
                <tr>
                    <td><code>RecycleBin</code></td>
                    <td>Recycle bin contents</td>
                </tr>
                <tr>
                    <td><code>BrowserHistory</code></td>
                    <td>Browser artifacts</td>
                </tr>
                <tr>
                    <td><code>WebBrowsers</code></td>
                    <td>All browser data</td>
                </tr>
                <tr>
                    <td><code>LnkFilesAndJumpLists</code></td>
                    <td>LNK and Jump Lists</td>
                </tr>
            </tbody>
        </table>
        <p><strong>Common Modules</strong>:</p>
        <table>
            <thead>
                <tr>
                    <th>Module</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>!EZParser</code></td>
                    <td>All EZ tools</td>
                </tr>
                <tr>
                    <td><code>Chainsaw</code></td>
                    <td>Event log hunting</td>
                </tr>
                <tr>
                    <td><code>Hayabusa</code></td>
                    <td>Event log analysis</td>
                </tr>
                <tr>
                    <td><code>RegRipper</code></td>
                    <td>Registry parsing</td>
                </tr>
            </tbody>
        </table>
        <hr />
        <h2>RegRipper</h2>
        <p><strong>Purpose</strong>: Registry analysis with pre-built plugins</p>
        <p><strong>CTF Use Cases</strong>:</p>
        <ul>
            <li>Quick extraction of specific artifacts</li>
            <li>Automated registry analysis</li>
            <li>Timeline creation from registry</li>
            <li>Plugin-based customization</li>
        </ul>
        <p><strong>Key Commands</strong>:</p>
        <pre><code class="language-powershell"># Run all plugins for a hive type
rip.exe -r NTUSER.DAT -a &gt; ntuser_output.txt

# Run specific plugin
rip.exe -r NTUSER.DAT -p userassist &gt; userassist.txt

# List plugins
rip.exe -l

# List plugins for specific hive
rip.exe -l -c ntuser

# Run plugin with timeline output
rip.exe -r SYSTEM -p shimcache -t &gt; shimcache_tln.txt

# Common plugin combinations
rip.exe -r SAM -a &gt; sam_output.txt
rip.exe -r SECURITY -a &gt; security_output.txt
rip.exe -r SOFTWARE -a &gt; software_output.txt
rip.exe -r SYSTEM -a &gt; system_output.txt
</code></pre>
        <p><strong>Key Plugins by Hive</strong>:</p>
        <p><strong>NTUSER.DAT</strong>:</p>
        <table>
            <thead>
                <tr>
                    <th>Plugin</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>userassist</code></td>
                    <td>GUI program execution</td>
                </tr>
                <tr>
                    <td><code>recentdocs</code></td>
                    <td>Recently opened documents</td>
                </tr>
                <tr>
                    <td><code>typedpaths</code></td>
                    <td>Explorer address bar history</td>
                </tr>
                <tr>
                    <td><code>typedurls</code></td>
                    <td>IE typed URLs</td>
                </tr>
                <tr>
                    <td><code>runmru</code></td>
                    <td>Run dialog history</td>
                </tr>
                <tr>
                    <td><code>comdlg32</code></td>
                    <td>Open/Save dialog history</td>
                </tr>
                <tr>
                    <td><code>wordwheelquery</code></td>
                    <td>Explorer search history</td>
                </tr>
                <tr>
                    <td><code>mountpoints2</code></td>
                    <td>Mounted devices</td>
                </tr>
                <tr>
                    <td><code>shellbags</code></td>
                    <td>Folder access history</td>
                </tr>
            </tbody>
        </table>
        <p><strong>SYSTEM</strong>:</p>
        <table>
            <thead>
                <tr>
                    <th>Plugin</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>shimcache</code></td>
                    <td>Application compatibility cache</td>
                </tr>
                <tr>
                    <td><code>services</code></td>
                    <td>Windows services</td>
                </tr>
                <tr>
                    <td><code>compname</code></td>
                    <td>Computer name</td>
                </tr>
                <tr>
                    <td><code>timezone</code></td>
                    <td>System timezone</td>
                </tr>
                <tr>
                    <td><code>nic2</code></td>
                    <td>Network interfaces</td>
                </tr>
                <tr>
                    <td><code>usbstor</code></td>
                    <td>USB storage devices</td>
                </tr>
                <tr>
                    <td><code>usbdevices</code></td>
                    <td>USB devices</td>
                </tr>
                <tr>
                    <td><code>bam</code></td>
                    <td>Background Activity Moderator</td>
                </tr>
            </tbody>
        </table>
        <p><strong>SOFTWARE</strong>:</p>
        <table>
            <thead>
                <tr>
                    <th>Plugin</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>profilelist</code></td>
                    <td>User profile information</td>
                </tr>
                <tr>
                    <td><code>networklist</code></td>
                    <td>Network connection history</td>
                </tr>
                <tr>
                    <td><code>run</code></td>
                    <td>Run key persistence</td>
                </tr>
                <tr>
                    <td><code>uninstall</code></td>
                    <td>Installed programs</td>
                </tr>
                <tr>
                    <td><code>svc</code></td>
                    <td>Services configuration</td>
                </tr>
                <tr>
                    <td><code>lastloggedon</code></td>
                    <td>Last logged on user</td>
                </tr>
            </tbody>
        </table>
        <p><strong>SAM</strong>:</p>
        <table>
            <thead>
                <tr>
                    <th>Plugin</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>samparse</code></td>
                    <td>User account information</td>
                </tr>
            </tbody>
        </table>
        <hr />
        <h2>Chainsaw</h2>
        <p><strong>Purpose</strong>: Fast Windows Event Log hunting using Sigma rules</p>
        <p><strong>CTF Use Cases</strong>:</p>
        <ul>
            <li>Quick threat hunting in event logs</li>
            <li>Sigma rule detection</li>
            <li>Lateral movement detection</li>
            <li>Malware behavior hunting</li>
        </ul>
        <p><strong>Key Commands</strong>:</p>
        <pre><code class="language-bash"># Hunt with all sigma rules
chainsaw hunt C:\Logs\ -s sigma/ --mapping mappings/sigma-event-logs-all.yml

# Hunt specific log file
chainsaw hunt Security.evtx -s sigma/ --mapping mappings/sigma-event-logs-all.yml

# Search for specific string
chainsaw search "mimikatz" C:\Logs\

# Search with regex
chainsaw search -e "(?i)password" C:\Logs\

# Output to CSV
chainsaw hunt C:\Logs\ -s sigma/ --mapping mappings/sigma-event-logs-all.yml --csv --output results.csv

# JSON output
chainsaw hunt C:\Logs\ -s sigma/ --mapping mappings/sigma-event-logs-all.yml --json --output results.json

# Quiet mode (critical only)
chainsaw hunt C:\Logs\ -s sigma/ --mapping mappings/sigma-event-logs-all.yml --level critical

# Dump all events as JSON
chainsaw dump C:\Logs\ --json
</code></pre>
        <p><strong>Sigma Rule Categories</strong>:</p>
        <pre><code>- lateral_movement
- credential_access
- persistence
- privilege_escalation
- defense_evasion
- execution
- discovery
- exfiltration
</code></pre>
        <hr />
        <h2>Hayabusa</h2>
        <p><strong>Purpose</strong>: Windows Event Log fast forensics timeline generator</p>
        <p><strong>CTF Use Cases</strong>:</p>
        <ul>
            <li>Event log timeline creation</li>
            <li>Sigma-based detection</li>
            <li>CSV/JSON timeline output</li>
            <li>Multi-log correlation</li>
        </ul>
        <p><strong>Key Commands</strong>:</p>
        <pre><code class="language-bash"># Create CSV timeline
hayabusa csv-timeline -d C:\Logs\ -o timeline.csv

# Create JSON timeline
hayabusa json-timeline -d C:\Logs\ -o timeline.json

# Live analysis (Windows)
hayabusa csv-timeline -l -o live_timeline.csv

# With all events (not just alerts)
hayabusa csv-timeline -d C:\Logs\ -o timeline.csv -p all-field-info-verbose

# Minimum level
hayabusa csv-timeline -d C:\Logs\ -o timeline.csv -m high

# Update rules
hayabusa update-rules

# Metrics summary
hayabusa metrics -d C:\Logs\

# Computer metrics
hayabusa computer-metrics -d C:\Logs\
</code></pre>
        <p><strong>Output Columns</strong>:</p>
        <table>
            <thead>
                <tr>
                    <th>Column</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Timestamp</td>
                    <td>Event timestamp</td>
                </tr>
                <tr>
                    <td>Computer</td>
                    <td>Computer name</td>
                </tr>
                <tr>
                    <td>Channel</td>
                    <td>Log channel</td>
                </tr>
                <tr>
                    <td>EventID</td>
                    <td>Event ID</td>
                </tr>
                <tr>
                    <td>Level</td>
                    <td>Alert level</td>
                </tr>
                <tr>
                    <td>RecordID</td>
                    <td>Event record ID</td>
                </tr>
                <tr>
                    <td>RuleTitle</td>
                    <td>Detection rule name</td>
                </tr>
                <tr>
                    <td>Details</td>
                    <td>Event details</td>
                </tr>
            </tbody>
        </table>
        <hr />
        <h2>Volatility 3 (Memory Forensics)</h2>
        <p><strong>Purpose</strong>: Memory image analysis</p>
        <p><strong>CTF Use Cases</strong>:</p>
        <ul>
            <li>Process analysis</li>
            <li>Network connections</li>
            <li>Injected code detection</li>
            <li>Credential extraction</li>
            <li>Malware analysis</li>
        </ul>
        <p><strong>Key Commands</strong>:</p>
        <pre><code class="language-bash"># System info
vol -f memory.raw windows.info

# Process listing
vol -f memory.raw windows.pslist
vol -f memory.raw windows.pstree
vol -f memory.raw windows.psscan  # Find hidden processes

# Process command line
vol -f memory.raw windows.cmdline

# DLL listing
vol -f memory.raw windows.dlllist --pid 1234

# Network connections
vol -f memory.raw windows.netstat
vol -f memory.raw windows.netscan

# Registry hives
vol -f memory.raw windows.registry.hivelist
vol -f memory.raw windows.registry.printkey --key "Software\Microsoft\Windows\CurrentVersion\Run"

# File handles
vol -f memory.raw windows.handles --pid 1234

# Memory dump
vol -f memory.raw windows.memmap --pid 1234 --dump

# Process dump
vol -f memory.raw windows.pslist --pid 1234 --dump

# Malfind (injected code)
vol -f memory.raw windows.malfind

# Password hashes
vol -f memory.raw windows.hashdump

# LSA secrets
vol -f memory.raw windows.lsadump

# Environment variables
vol -f memory.raw windows.envars

# Services
vol -f memory.raw windows.svcscan

# Files in memory
vol -f memory.raw windows.filescan

# Dump file from memory
vol -f memory.raw windows.dumpfiles --virtaddr 0xADDRESS

# Strings extraction (use external tool)
strings -a memory.raw &gt; strings.txt
strings -el memory.raw &gt;&gt; strings.txt  # Unicode
</code></pre>
        <p><strong>Plugin Categories</strong>:</p>
        <table>
            <thead>
                <tr>
                    <th>Category</th>
                    <th>Plugins</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Process</td>
                    <td><code>pslist</code>, <code>pstree</code>, <code>psscan</code>, <code>cmdline</code>,
                        <code>envars</code>
                    </td>
                </tr>
                <tr>
                    <td>Memory</td>
                    <td><code>memmap</code>, <code>vadinfo</code>, <code>vadwalk</code>, <code>malfind</code></td>
                </tr>
                <tr>
                    <td>DLLs</td>
                    <td><code>dlllist</code>, <code>ldrmodules</code></td>
                </tr>
                <tr>
                    <td>Network</td>
                    <td><code>netscan</code>, <code>netstat</code></td>
                </tr>
                <tr>
                    <td>Registry</td>
                    <td><code>hivelist</code>, <code>printkey</code>, <code>hivedump</code></td>
                </tr>
                <tr>
                    <td>Files</td>
                    <td><code>filescan</code>, <code>dumpfiles</code></td>
                </tr>
                <tr>
                    <td>Credentials</td>
                    <td><code>hashdump</code>, <code>lsadump</code>, <code>cachedump</code></td>
                </tr>
                <tr>
                    <td>Services</td>
                    <td><code>svcscan</code>, <code>getservicesids</code></td>
                </tr>
            </tbody>
        </table>
        <hr />
        <h2>Autopsy / The Sleuth Kit</h2>
        <p><strong>Purpose</strong>: GUI forensic platform and command-line tools</p>
        <p><strong>Autopsy Key Features</strong>:</p>
        <ul>
            <li>Disk image analysis</li>
            <li>Timeline creation</li>
            <li>Keyword searching</li>
            <li>File recovery</li>
            <li>Hash analysis</li>
            <li>Report generation</li>
        </ul>
        <p><strong>Sleuth Kit Commands</strong>:</p>
        <pre><code class="language-bash"># Image information
img_stat image.E01

# File system info
fsstat -o 2048 image.E01

# List files
fls -r -o 2048 image.E01

# File content
icat -o 2048 image.E01 12345  # By inode

# Deleted files
fls -r -d -o 2048 image.E01

# MFT parsing
icat -o 2048 image.E01 0 &gt; mft.raw  # MFT is inode 0

# Timeline creation
fls -r -m "/" -o 2048 image.E01 &gt; bodyfile.txt
mactime -b bodyfile.txt &gt; timeline.csv

# Keyword search
srch_strings -a image.E01 | grep -i "password"

# Partition table
mmls image.E01

# Hash database lookup (nsrl)
hfind -i nsrlsha1 nsrl.txt [sha1_hash]
</code></pre>
        <hr />
        <h2>Additional Essential Tools</h2>
        <h3>Arsenal Image Mounter</h3>
        <pre><code class="language-powershell"># Mount forensic image as disk
aim_cli.exe --mount --readonly --filename="image.E01"

# Mount with fake disk signature
aim_cli.exe --mount --readonly --fakesig --filename="image.E01"

# List mounted devices
aim_cli.exe --list

# Unmount
aim_cli.exe --dismount --device=\\.\PhysicalDrive1
</code></pre>
        <h3>FTK Imager</h3>
        <ul>
            <li>Mount images</li>
            <li>Extract files</li>
            <li>Create forensic images</li>
            <li>View file contents</li>
            <li>Export registry hives</li>
        </ul>
        <h3>Event Log Explorer</h3>
        <ul>
            <li>GUI event log viewer</li>
            <li>Filter and search</li>
            <li>Bookmark events</li>
            <li>Export to various formats</li>
        </ul>
        <h3>NirSoft Tools</h3>
        <pre><code class="language-powershell"># Browser history (multiple browsers)
BrowsingHistoryView.exe /scomma output.csv

# USB device history
USBDeview.exe /scomma usb_output.csv

# Last activity
LastActivityView.exe /scomma activity.csv

# Shell bags
ShellBagsView.exe /scomma shellbags.csv
</code></pre>
        <h3>Hindsight (Chrome/Edge History)</h3>
        <pre><code class="language-bash"># Parse Chrome profile
python hindsight.py -i "C:\Users\user\AppData\Local\Google\Chrome\User Data\Default" -o output

# Specify output format
python hindsight.py -i "C:\path\Default" -o output -f xlsx
</code></pre>
        <h3>SQLECmd (Eric Zimmerman)</h3>
        <pre><code class="language-powershell"># Parse SQLite databases with maps
SQLECmd.exe -f "C:\path\database.sqlite" --maps "C:\Tools\SQLECmd\Maps" --csv C:\output

# Parse all SQLite in directory
SQLECmd.exe -d "C:\path" --maps "C:\Tools\SQLECmd\Maps" --csv C:\output
</code></pre>
        <hr />
        <h1>üìù Registry Analysis</h1>
        <h2>Registry Hive Locations and Content</h2>
        <table>
            <thead>
                <tr>
                    <th>Hive</th>
                    <th>Location</th>
                    <th>Content</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>SYSTEM</strong></td>
                    <td><code>C:\Windows\System32\config\SYSTEM</code></td>
                    <td>Hardware, services, boot config</td>
                </tr>
                <tr>
                    <td><strong>SOFTWARE</strong></td>
                    <td><code>C:\Windows\System32\config\SOFTWARE</code></td>
                    <td>Installed software, OS config</td>
                </tr>
                <tr>
                    <td><strong>SAM</strong></td>
                    <td><code>C:\Windows\System32\config\SAM</code></td>
                    <td>User accounts, password hashes</td>
                </tr>
                <tr>
                    <td><strong>SECURITY</strong></td>
                    <td><code>C:\Windows\System32\config\SECURITY</code></td>
                    <td>Security policies, LSA secrets</td>
                </tr>
                <tr>
                    <td><strong>NTUSER.DAT</strong></td>
                    <td><code>C:\Users\\NTUSER.DAT</code></td>
                    <td>User preferences, activity</td>
                </tr>
                <tr>
                    <td><strong>UsrClass.dat</strong></td>
                    <td><code>C:\Users\\AppData\Local\Microsoft\Windows\UsrClass.dat</code></td>
                    <td>ShellBags, COM settings</td>
                </tr>
                <tr>
                    <td><strong>Amcache.hve</strong></td>
                    <td><code>C:\Windows\AppCompat\Programs\Amcache.hve</code></td>
                    <td>Program execution, SHA1 hashes</td>
                </tr>
            </tbody>
        </table>
        <h2>High-Value Registry Keys</h2>
        <h3>Persistence Mechanisms</h3>
        <pre><code># Run Keys (per user)
NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Run
NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\RunOnce

# Run Keys (system-wide)
SOFTWARE\Microsoft\Windows\CurrentVersion\Run
SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce
SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run
SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\Run

# Services
SYSTEM\CurrentControlSet\Services\

# Scheduled Tasks (backup location)
SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks\
SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree\

# Winlogon
SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon
- Shell (default: explorer.exe)
- Userinit (default: userinit.exe)

# AppInit_DLLs
SOFTWARE\Microsoft\Windows NT\CurrentVersion\Windows\AppInit_DLLs
SOFTWARE\WOW6432Node\Microsoft\Windows NT\CurrentVersion\Windows\AppInit_DLLs

# Image File Execution Options (IFEO)
SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\
- Debugger value = persistence/hijacking

# Shell Extensions
SOFTWARE\Microsoft\Windows\CurrentVersion\Shell Extensions\Approved
SOFTWARE\Classes\*\shellex\ContextMenuHandlers

# Browser Helper Objects
SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Browser Helper Objects

# Boot Execute
SYSTEM\CurrentControlSet\Control\Session Manager\BootExecute
</code></pre>
        <h3>Program Execution Evidence</h3>
        <pre><code># UserAssist (GUI programs - ROT13 encoded)
NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\UserAssist\{GUID}\Count

# ShimCache / AppCompatCache
SYSTEM\CurrentControlSet\Control\Session Manager\AppCompatCache

# Background Activity Moderator (BAM) - Win10 1709+
SYSTEM\CurrentControlSet\Services\bam\State\UserSettings\{SID}
SYSTEM\CurrentControlSet\Services\dam\State\UserSettings\{SID}

# MUI Cache (executable descriptions)
NTUSER.DAT\Software\Classes\Local Settings\Software\Microsoft\Windows\Shell\MuiCache
</code></pre>
        <h3>User Activity</h3>
        <pre><code># Recent Documents
NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs

# Typed Paths (Explorer address bar)
NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\TypedPaths

# Run Dialog MRU
NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\RunMRU

# Open/Save Dialog MRU
NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32\OpenSavePidlMRU
NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32\LastVisitedPidlMRU

# Search History
NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\WordWheelQuery

# Last Commands
NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\RunMRU
</code></pre>
        <h3>USB/Removable Devices</h3>
        <pre><code># USB Storage Devices
SYSTEM\CurrentControlSet\Enum\USBSTOR
SYSTEM\CurrentControlSet\Enum\USB

# Mounted Devices
SYSTEM\MountedDevices

# Drive Letters per User
NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\MountPoints2

# USB Connection Times (setupapi.dev.log)
C:\Windows\INF\setupapi.dev.log

# First/Last Connection
SYSTEM\CurrentControlSet\Enum\USBSTOR\{Device}\{Instance}
- FirstInstallDate
- LastArrivalDate
- LastRemovalDate (Win10+)
</code></pre>
        <h3>Network Configuration</h3>
        <pre><code># Network Interfaces
SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\Interfaces\{GUID}

# Network List (profiles)
SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkList\Profiles\
SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkList\Signatures\

# Shares
SYSTEM\CurrentControlSet\Services\LanmanServer\Shares
</code></pre>
        <h3>System Information</h3>
        <pre><code># Computer Name
SYSTEM\CurrentControlSet\Control\ComputerName\ComputerName

# Timezone
SYSTEM\CurrentControlSet\Control\TimeZoneInformation

# Last Shutdown
SYSTEM\CurrentControlSet\Control\Windows\ShutdownTime

# OS Version
SOFTWARE\Microsoft\Windows NT\CurrentVersion

# Profile List (Users)
SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProfileList
</code></pre>
        <hr />
        <h1>üìä Event Log Analysis</h1>
        <h2>Key Event Log Locations</h2>
        <pre><code>üìÅ All Event Logs: C:\Windows\System32\winevt\Logs\

Primary Logs:
- Security.evtx
- System.evtx  
- Application.evtx

PowerShell:
- Microsoft-Windows-PowerShell%4Operational.evtx
- Windows PowerShell.evtx

Scheduled Tasks:
- Microsoft-Windows-TaskScheduler%4Operational.evtx

Terminal Services/RDP:
- Microsoft-Windows-TerminalServices-LocalSessionManager%4Operational.evtx
- Microsoft-Windows-TerminalServices-RemoteConnectionManager%4Operational.evtx

Windows Defender:
- Microsoft-Windows-Windows Defender%4Operational.evtx

Sysmon (if installed):
- Microsoft-Windows-Sysmon%4Operational.evtx

Bits:
- Microsoft-Windows-Bits-Client%4Operational.evtx
</code></pre>
        <h2>Event Log Analysis by Investigation Type</h2>
        <h3>Authentication Analysis</h3>
        <table>
            <thead>
                <tr>
                    <th>Event ID</th>
                    <th>Log</th>
                    <th>Meaning</th>
                    <th>Key Fields</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>4624</td>
                    <td>Security</td>
                    <td>Successful Logon</td>
                    <td><code>LogonType</code>, <code>TargetUserName</code>, <code>IpAddress</code>,
                        <code>WorkstationName</code>
                    </td>
                </tr>
                <tr>
                    <td>4625</td>
                    <td>Security</td>
                    <td>Failed Logon</td>
                    <td><code>LogonType</code>, <code>TargetUserName</code>, <code>IpAddress</code>,
                        <code>FailureReason</code>
                    </td>
                </tr>
                <tr>
                    <td>4634/4647</td>
                    <td>Security</td>
                    <td>Logoff</td>
                    <td><code>TargetUserName</code>, <code>LogonType</code></td>
                </tr>
                <tr>
                    <td>4648</td>
                    <td>Security</td>
                    <td>Explicit Credentials</td>
                    <td><code>SubjectUserName</code>, <code>TargetUserName</code>, <code>TargetServerName</code></td>
                </tr>
                <tr>
                    <td>4672</td>
                    <td>Security</td>
                    <td>Special Privileges</td>
                    <td><code>SubjectUserName</code>, <code>PrivilegeList</code></td>
                </tr>
                <tr>
                    <td>4776</td>
                    <td>Security</td>
                    <td>NTLM Auth</td>
                    <td><code>TargetUserName</code>, <code>Workstation</code></td>
                </tr>
                <tr>
                    <td>4768</td>
                    <td>Security</td>
                    <td>Kerberos TGT Request</td>
                    <td><code>TargetUserName</code>, <code>IpAddress</code></td>
                </tr>
                <tr>
                    <td>4769</td>
                    <td>Security</td>
                    <td>Kerberos Service Ticket</td>
                    <td><code>TargetUserName</code>, <code>ServiceName</code></td>
                </tr>
                <tr>
                    <td>4771</td>
                    <td>Security</td>
                    <td>Kerberos Pre-Authentication Failed</td>
                    <td><code>TargetUserName</code>, <code>IpAddress</code>, <code>Status</code></td>
                </tr>
                <tr>
                    <td>4722</td>
                    <td>Security</td>
                    <td>User Account Enabled</td>
                    <td><code>TargetUserName</code>, <code>SubjectUserName</code></td>
                </tr>
            </tbody>
        </table>
        <h3>Process Execution</h3>
        <table>
            <thead>
                <tr>
                    <th>Event ID</th>
                    <th>Log</th>
                    <th>Meaning</th>
                    <th>Key Fields</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>4688</td>
                    <td>Security</td>
                    <td>Process Creation</td>
                    <td><code>NewProcessName</code>, <code>CommandLine</code>, <code>ParentProcessName</code>,
                        <code>SubjectUserName</code>
                    </td>
                </tr>
                <tr>
                    <td>4689</td>
                    <td>Security</td>
                    <td>Process Termination</td>
                    <td><code>ProcessName</code>, <code>SubjectUserName</code></td>
                </tr>
                <tr>
                    <td>1</td>
                    <td>Sysmon</td>
                    <td>Process Create</td>
                    <td><code>Image</code>, <code>CommandLine</code>, <code>ParentImage</code>, <code>User</code>,
                        <code>Hashes</code>
                    </td>
                </tr>
                <tr>
                    <td>5</td>
                    <td>Sysmon</td>
                    <td>Process Terminated</td>
                    <td><code>Image</code>, <code>User</code></td>
                </tr>
            </tbody>
        </table>
        <h3>Lateral Movement Indicators</h3>
        <table>
            <thead>
                <tr>
                    <th>Event ID</th>
                    <th>Log</th>
                    <th>Meaning</th>
                    <th>Key Fields</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>4624 (Type 3)</td>
                    <td>Security</td>
                    <td>Network Logon</td>
                    <td><code>IpAddress</code>, <code>TargetUserName</code></td>
                </tr>
                <tr>
                    <td>4624 (Type 10)</td>
                    <td>Security</td>
                    <td>RDP Logon</td>
                    <td><code>IpAddress</code>, <code>TargetUserName</code></td>
                </tr>
                <tr>
                    <td>4648</td>
                    <td>Security</td>
                    <td>Explicit Creds</td>
                    <td><code>TargetServerName</code>, <code>TargetUserName</code></td>
                </tr>
                <tr>
                    <td>21</td>
                    <td>TS-Local</td>
                    <td>RDP Session Logon</td>
                    <td><code>User</code>, <code>Source Network Address</code></td>
                </tr>
                <tr>
                    <td>22</td>
                    <td>TS-Local</td>
                    <td>Shell Start</td>
                    <td><code>User</code></td>
                </tr>
                <tr>
                    <td>25</td>
                    <td>TS-Local</td>
                    <td>Reconnect</td>
                    <td><code>User</code>, <code>Source Network Address</code></td>
                </tr>
                <tr>
                    <td>1149</td>
                    <td>TS-Remote</td>
                    <td>RDP Auth Success</td>
                    <td><code>User</code>, <code>Source Network Address</code></td>
                </tr>
                <tr>
                    <td>23</td>
                    <td>TS-Local</td>
                    <td>RDP Session Logoff</td>
                    <td><code>User</code>, <code>SessionID</code></td>
                </tr>
                <tr>
                    <td>24</td>
                    <td>TS-Local</td>
                    <td>RDP Session Disconnected</td>
                    <td><code>User</code>, <code>SessionID</code>, <code>Source Network Address</code></td>
                </tr>
                <tr>
                    <td>1029</td>
                    <td>TS-RDPClient</td>
                    <td>Source RDP Connection (Username Hash)</td>
                    <td><code>CalledStationID</code> (Base64 SHA256 of username)</td>
                </tr>
            </tbody>
        </table>
        <h3>Persistence</h3>
        <table>
            <thead>
                <tr>
                    <th>Event ID</th>
                    <th>Log</th>
                    <th>Meaning</th>
                    <th>Key Fields</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>7045</td>
                    <td>System</td>
                    <td>Service Install</td>
                    <td><code>ServiceName</code>, <code>ImagePath</code>, <code>ServiceType</code></td>
                </tr>
                <tr>
                    <td>7040</td>
                    <td>System</td>
                    <td>Service Start Type Changed</td>
                    <td><code>ServiceName</code>, <code>StartType</code></td>
                </tr>
                <tr>
                    <td>4698</td>
                    <td>Security</td>
                    <td>Scheduled Task Created</td>
                    <td><code>TaskName</code>, <code>TaskContent</code></td>
                </tr>
                <tr>
                    <td>4699</td>
                    <td>Security</td>
                    <td>Scheduled Task Deleted</td>
                    <td><code>TaskName</code></td>
                </tr>
                <tr>
                    <td>4702</td>
                    <td>Security</td>
                    <td>Scheduled Task Updated</td>
                    <td><code>TaskName</code>, <code>TaskContent</code></td>
                </tr>
                <tr>
                    <td>106</td>
                    <td>TaskScheduler</td>
                    <td>Task Registered</td>
                    <td><code>TaskName</code></td>
                </tr>
                <tr>
                    <td>200/201</td>
                    <td>TaskScheduler</td>
                    <td>Task Executed/Completed</td>
                    <td><code>TaskName</code>, <code>ActionName</code></td>
                </tr>
                <tr>
                    <td>13</td>
                    <td>Sysmon</td>
                    <td>Registry Value Set</td>
                    <td><code>TargetObject</code>, <code>Details</code></td>
                </tr>
                <tr>
                    <td>100</td>
                    <td>TaskScheduler</td>
                    <td>Task Scheduler Started Task Instance</td>
                    <td><code>TaskName</code>, <code>InstanceId</code></td>
                </tr>
                <tr>
                    <td>102</td>
                    <td>TaskScheduler</td>
                    <td>Task Scheduler Successfully Finished Task</td>
                    <td><code>TaskName</code>, <code>InstanceId</code></td>
                </tr>
                <tr>
                    <td>141</td>
                    <td>TaskScheduler</td>
                    <td>Task Scheduler Deleted Task</td>
                    <td><code>TaskName</code>, <code>UserName</code></td>
                </tr>
                <tr>
                    <td>7009</td>
                    <td>System</td>
                    <td>Service Connection Timeout</td>
                    <td><code>ServiceName</code></td>
                </tr>
                <tr>
                    <td>7034</td>
                    <td>System</td>
                    <td>Service Terminated Unexpectedly</td>
                    <td><code>ServiceName</code>, <code>ServiceExitCode</code></td>
                </tr>
            </tbody>
        </table>
        <h3>PowerShell Activity</h3>
        <table>
            <thead>
                <tr>
                    <th>Event ID</th>
                    <th>Log</th>
                    <th>Meaning</th>
                    <th>Key Fields</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>4103</td>
                    <td>PowerShell Operational</td>
                    <td>Module Logging</td>
                    <td><code>Payload</code></td>
                </tr>
                <tr>
                    <td>4104</td>
                    <td>PowerShell Operational</td>
                    <td>Script Block Logging</td>
                    <td><code>ScriptBlockText</code></td>
                </tr>
                <tr>
                    <td>400</td>
                    <td>Windows PowerShell</td>
                    <td>Engine Start</td>
                    <td><code>HostApplication</code></td>
                </tr>
                <tr>
                    <td>403</td>
                    <td>Windows PowerShell</td>
                    <td>Engine Stop</td>
                    <td><code>HostApplication</code></td>
                </tr>
                <tr>
                    <td>800</td>
                    <td>Windows PowerShell</td>
                    <td>Pipeline Execution</td>
                    <td>Details</td>
                </tr>
                <tr>
                    <td>600</td>
                    <td>Windows PowerShell</td>
                    <td>Provider Started</td>
                    <td><code>ProviderName</code>, <code>NewProviderState</code></td>
                </tr>
            </tbody>
        </table>
        <h3>Anti-Forensics Detection</h3>
        <table>
            <thead>
                <tr>
                    <th>Event ID</th>
                    <th>Log</th>
                    <th>Meaning</th>
                    <th>Implication</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>1102</td>
                    <td>Security</td>
                    <td>Audit Log Cleared</td>
                    <td>Evidence destruction</td>
                </tr>
                <tr>
                    <td>104</td>
                    <td>System</td>
                    <td>Log Cleared</td>
                    <td>Evidence destruction</td>
                </tr>
                <tr>
                    <td>1100</td>
                    <td>Security</td>
                    <td>Event Logging Shutdown</td>
                    <td>Logging stopped</td>
                </tr>
            </tbody>
        </table>
        <h3>Reconnaissance &amp; Enumeration</h3>
        <table>
            <thead>
                <tr>
                    <th>Event ID</th>
                    <th>Log</th>
                    <th>Meaning</th>
                    <th>Key Fields</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>4798</td>
                    <td>Security</td>
                    <td>User Local Group Membership Enumerated</td>
                    <td><code>TargetUserName</code>, <code>SubjectUserName</code>, <code>CallerProcessName</code></td>
                </tr>
                <tr>
                    <td>4799</td>
                    <td>Security</td>
                    <td>Security-Enabled Local Group Membership Enumerated</td>
                    <td><code>TargetUserName</code>, <code>SubjectUserName</code>, <code>CallerProcessName</code></td>
                </tr>
            </tbody>
        </table>
        <h3>Network Share Access</h3>
        <table>
            <thead>
                <tr>
                    <th>Event ID</th>
                    <th>Log</th>
                    <th>Meaning</th>
                    <th>Key Fields</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>5140</td>
                    <td>Security</td>
                    <td>Network Share Object Accessed</td>
                    <td><code>ShareName</code>, <code>IpAddress</code>, <code>SubjectUserName</code></td>
                </tr>
                <tr>
                    <td>5145</td>
                    <td>Security</td>
                    <td>Network Share Access Check</td>
                    <td><code>ShareName</code>, <code>RelativeTargetName</code>, <code>AccessMask</code></td>
                </tr>
            </tbody>
        </table>
        <h3>Windows Defender</h3>
        <table>
            <thead>
                <tr>
                    <th>Event ID</th>
                    <th>Log</th>
                    <th>Meaning</th>
                    <th>Key Fields</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>1116</td>
                    <td>Windows Defender/Operational</td>
                    <td>Malware Detected</td>
                    <td><code>Threat Name</code>, <code>Detection User</code>, <code>Process Name</code>, <code>Path</code></td>
                </tr>
                <tr>
                    <td>1117</td>
                    <td>Windows Defender/Operational</td>
                    <td>Malware Remediation Action Taken</td>
                    <td><code>Threat Name</code>, <code>Action Name</code>, <code>Process Name</code></td>
                </tr>
            </tbody>
        </table>
        <h3>Application Errors &amp; Crashes</h3>
        <table>
            <thead>
                <tr>
                    <th>Event ID</th>
                    <th>Log</th>
                    <th>Meaning</th>
                    <th>Key Fields</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>1000</td>
                    <td>Application</td>
                    <td>Application Error</td>
                    <td><code>Application Name</code>, <code>Application Version</code>, <code>Fault Module</code></td>
                </tr>
                <tr>
                    <td>1002</td>
                    <td>Application</td>
                    <td>Application Hang</td>
                    <td><code>Application Name</code>, <code>Application Version</code></td>
                </tr>
            </tbody>
        </table>
        <h3>Database Activity (ESENT)</h3>
        <table>
            <thead>
                <tr>
                    <th>Event ID</th>
                    <th>Log</th>
                    <th>Meaning</th>
                    <th>Key Fields</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>216</td>
                    <td>Application (ESENT)</td>
                    <td>Database Location Change Detected</td>
                    <td><code>Database</code>, <code>Old Location</code>, <code>New Location</code></td>
                </tr>
                <tr>
                    <td>325</td>
                    <td>Application (ESENT)</td>
                    <td>Database Engine Created New Database</td>
                    <td><code>Database</code></td>
                </tr>
                <tr>
                    <td>326</td>
                    <td>Application (ESENT)</td>
                    <td>Database Engine Attached Database</td>
                    <td><code>Database</code></td>
                </tr>
                <tr>
                    <td>327</td>
                    <td>Application (ESENT)</td>
                    <td>Database Engine Detached Database</td>
                    <td><code>Database</code></td>
                </tr>
            </tbody>
        </table>
        <h2>Event Log Quick Analysis Commands</h2>
        <pre><code class="language-powershell"># PowerShell - Quick Event Log Analysis

# Get recent security events
Get-WinEvent -LogName Security -MaxEvents 100 | 
    Select-Object TimeCreated, Id, Message

# Find specific Event ID
Get-WinEvent -FilterHashtable @{LogName='Security'; Id=4624} |
    Select-Object TimeCreated, Id, Message

# Search for username in logs
Get-WinEvent -LogName Security | 
    Where-Object {$_.Message -like "*username*"}

# Export to CSV
Get-WinEvent -LogName Security | 
    Export-Csv -Path security_events.csv

# Parse from .evtx file
Get-WinEvent -Path "C:\Evidence\Security.evtx" -MaxEvents 100

# Multiple Event IDs
Get-WinEvent -FilterHashtable @{
    LogName='Security'
    Id=4624,4625,4648,4672
} | Select-Object TimeCreated, Id, Message
</code></pre>
        <hr />
        <h1>üíæ File System Artifacts</h1>
        <h2>NTFS Artifacts</h2>
        <h3>Master File Table ($MFT)</h3>
        <p><strong>Location</strong>: <code>C:\$MFT</code> (root of NTFS volume)</p>
        <p><strong>Content</strong>:</p>
        <ul>
            <li>File/folder metadata</li>
            <li>All timestamps (MACB)</li>
            <li>File paths (via parent reference)</li>
            <li>File sizes</li>
            <li>Resident data (small files)</li>
        </ul>
        <p><strong>Key Attributes</strong>:</p>
        <table>
            <thead>
                <tr>
                    <th>Attribute</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>$STANDARD_INFORMATION</code></td>
                    <td>Timestamps (modifiable)</td>
                </tr>
                <tr>
                    <td><code>$FILE_NAME</code></td>
                    <td>Timestamps (harder to modify), file name</td>
                </tr>
                <tr>
                    <td><code>$DATA</code></td>
                    <td>File content (or pointer to clusters)</td>
                </tr>
                <tr>
                    <td><code>$INDEX_ROOT</code></td>
                    <td>Directory index</td>
                </tr>
                <tr>
                    <td><code>$INDEX_ALLOCATION</code></td>
                    <td>Large directory index</td>
                </tr>
                <tr>
                    <td><code>$BITMAP</code></td>
                    <td>Cluster allocation map</td>
                </tr>
            </tbody>
        </table>
        <p><strong>Timestamps</strong> (MACB):</p>
        <ul>
            <li><strong>M</strong>odified: Content changed</li>
            <li><strong>A</strong>ccessed: Content read</li>
            <li><strong>C</strong>hanged: MFT entry modified (permissions, name, etc.)</li>
            <li><strong>B</strong>orn: Created</li>
        </ul>
        <h3>USN Journal (<span class="language-math">UsnJrnl:</span>J)</h3>
        <p><strong>Location</strong>: <code>C:\$Extend\$UsnJrnl:$J</code></p>
        <p><strong>Content</strong>:</p>
        <ul>
            <li>Real-time file system change log</li>
            <li>File creation, deletion, modification</li>
            <li>Rename operations</li>
            <li>Permission changes</li>
        </ul>
        <p><strong>Use Cases</strong>:</p>
        <ul>
            <li>Track file system changes</li>
            <li>Identify deleted files</li>
            <li>Malware activity timeline</li>
            <li>Data exfiltration indicators</li>
        </ul>
        <h3>$LogFile</h3>
        <p><strong>Location</strong>: <code>C:\$LogFile</code></p>
        <p><strong>Content</strong>:</p>
        <ul>
            <li>NTFS transaction log</li>
            <li>File system operations for crash recovery</li>
            <li>Short-term history (overwritten quickly)</li>
        </ul>
        <h3>Alternate Data Streams (ADS)</h3>
        <p><strong>Detection</strong>:</p>
        <pre><code class="language-powershell"># Find ADS
dir /R C:\path\
Get-Item -Path C:\path\file.txt -Stream *

# Read ADS content
Get-Content -Path C:\path\file.txt -Stream "HiddenStream"
more &lt; C:\path\file.txt:HiddenStream
</code></pre>
        <p><strong>Common Zone.Identifier ADS</strong>:</p>
        <pre><code>[ZoneTransfer]
ZoneId=3  # Internet
HostUrl=https://example.com/file.exe
</code></pre>
        <p><strong>Zone IDs</strong>:</p>
        <table>
            <thead>
                <tr>
                    <th>ZoneId</th>
                    <th>Source</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>0</td>
                    <td>Local machine</td>
                </tr>
                <tr>
                    <td>1</td>
                    <td>Local intranet</td>
                </tr>
                <tr>
                    <td>2</td>
                    <td>Trusted sites</td>
                </tr>
                <tr>
                    <td>3</td>
                    <td>Internet</td>
                </tr>
                <tr>
                    <td>4</td>
                    <td>Restricted sites</td>
                </tr>
            </tbody>
        </table>
        <h2>Recycle Bin</h2>
        <p><strong>Location</strong>: <code>C:\$Recycle.Bin\{SID}\</code></p>
        <p><strong>Files</strong>:</p>
        <ul>
            <li><code>$I&lt;id&gt;</code> - Metadata (original path, deletion time)</li>
            <li><code>$R&lt;id&gt;</code> - Actual file content</li>
        </ul>
        <p><strong>Analysis</strong>:</p>
        <pre><code class="language-powershell"># Using RBCmd (Eric Zimmerman)
RBCmd.exe -d "C:\$Recycle.Bin" --csv C:\output --csvf recyclebin.csv
</code></pre>
        <p><strong>Key Fields</strong>:</p>
        <table>
            <thead>
                <tr>
                    <th>Field</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>FileName</code></td>
                    <td>Original file name</td>
                </tr>
                <tr>
                    <td><code>FileSize</code></td>
                    <td>File size</td>
                </tr>
                <tr>
                    <td><code>DeletedOn</code></td>
                    <td>Deletion timestamp</td>
                </tr>
                <tr>
                    <td><code>SourceFile</code></td>
                    <td>$I file path (contains SID)</td>
                </tr>
            </tbody>
        </table>
        <h2>Volume Shadow Copies</h2>
        <p><strong>List VSS</strong>:</p>
        <pre><code class="language-powershell"># List shadow copies
vssadmin list shadows

# WMI method
Get-WmiObject Win32_ShadowCopy | Select-Object DeviceObject, InstallDate
</code></pre>
        <p><strong>Access VSS</strong>:</p>
        <pre><code class="language-cmd">:: Create symbolic link to VSS
mklink /d C:\VSS_Mount \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1\

:: Navigate
cd C:\VSS_Mount
</code></pre>
        <p><strong>CTF Use Cases</strong>:</p>
        <ul>
            <li>Recover deleted files</li>
            <li>Find previous versions of modified files</li>
            <li>Access files that were later encrypted</li>
            <li>Timeline of file changes</li>
        </ul>
        <h2>Thumbnail Cache</h2>
        <p><strong>Location</strong>: <code>C:\Users\&lt;user&gt;\AppData\Local\Microsoft\Windows\Explorer\</code></p>
        <p><strong>Files</strong>:</p>
        <ul>
            <li><code>thumbcache_*.db</code></li>
            <li><code>iconcache_*.db</code></li>
        </ul>
        <p><strong>Tool</strong>: Thumbcache Viewer</p>
        <p><strong>CTF Use Cases</strong>:</p>
        <ul>
            <li>Evidence of viewed images</li>
            <li>Recover deleted image thumbnails</li>
            <li>Prove file existence even after deletion</li>
        </ul>
        <hr />
        <h1>üë§ User Activity Analysis</h1>
        <h2>UserAssist</h2>
        <p><strong>Location</strong>:
            <code>NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\UserAssist\{GUID}\Count</code>
        </p>
        <p><strong>GUIDs</strong>:</p>
        <ul>
            <li><code>{CEBFF5CD-ACE2-4F4F-9178-9926F41749EA}</code> - Executable files</li>
            <li><code>{F4E57C4B-2036-45F0-A9AB-443BCFE33D9F}</code> - Shortcuts</li>
        </ul>
        <p><strong>Encoding</strong>: ROT13</p>
        <p><strong>Content</strong>:</p>
        <ul>
            <li>Program execution count</li>
            <li>Last execution time</li>
            <li>Focus time</li>
            <li>Focus count</li>
        </ul>
        <p><strong>Decoding</strong>:</p>
        <pre><code class="language-python">import codecs
encoded = "zvpebfbsg.rkr"
decoded = codecs.decode(encoded, 'rot_13')
print(decoded)  # microsoft.exe
</code></pre>
        <h2>Recent Files &amp; Folders</h2>
        <h3>Recent Documents</h3>
        <p><strong>Location</strong>:
            <code>NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs</code>
        </p>
        <p><strong>Subkeys by Extension</strong>:</p>
        <ul>
            <li><code>.pdf</code>, <code>.docx</code>, <code>.xlsx</code>, etc.</li>
            <li>Folder</li>
            <li>MRU list</li>
        </ul>
        <h3>LNK Files</h3>
        <p><strong>Location</strong>: <code>C:\Users\&lt;user&gt;\AppData\Roaming\Microsoft\Windows\Recent\</code></p>
        <p><strong>Content</strong>:</p>
        <ul>
            <li>Target file path</li>
            <li>Target timestamps</li>
            <li>Volume information</li>
            <li>Machine ID (NetBIOS name)</li>
        </ul>
        <h3>Jump Lists</h3>
        <p><strong>Locations</strong>:</p>
        <pre><code>Automatic: C:\Users\&lt;user&gt;\AppData\Roaming\Microsoft\Windows\Recent\AutomaticDestinations\
Custom: C:\Users\&lt;user&gt;\AppData\Roaming\Microsoft\Windows\Recent\CustomDestinations\
</code></pre>
        <h3>ShellBags</h3>
        <p><strong>Locations</strong>:</p>
        <pre><code>NTUSER.DAT: Software\Microsoft\Windows\Shell\Bags
           Software\Microsoft\Windows\Shell\BagMRU
UsrClass.dat: Local Settings\Software\Microsoft\Windows\Shell\Bags
              Local Settings\Software\Microsoft\Windows\Shell\BagMRU
</code></pre>
        <p><strong>Content</strong>:</p>
        <ul>
            <li>Folder access (including deleted folders)</li>
            <li>Folder view settings</li>
            <li>Network/removable paths</li>
        </ul>
        <h2>Search History</h2>
        <p><strong>Location</strong>:
            <code>NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\WordWheelQuery</code>
        </p>
        <p><strong>Content</strong>: Explorer search terms (MRU list)</p>
        <h2>Dialog History</h2>
        <p><strong>Open/Save Dialog</strong>:</p>
        <pre><code>NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32\OpenSavePidlMRU
NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32\LastVisitedPidlMRU
</code></pre>
        <p><strong>Last Visited MRU Fields</strong>:</p>
        <ul>
            <li>Executable used</li>
            <li>File path accessed</li>
        </ul>
        <h2>Background Activity Moderator (BAM/DAM)</h2>
        <p><strong>Location</strong> (Windows 10 1709+):</p>
        <pre><code>SYSTEM\CurrentControlSet\Services\bam\State\UserSettings\{SID}
SYSTEM\CurrentControlSet\Services\dam\State\UserSettings\{SID}
</code></pre>
        <p><strong>Content</strong>:</p>
        <ul>
            <li>Executable full paths</li>
            <li>Last execution timestamp</li>
            <li>Per-user tracking</li>
        </ul>
        <h2>MUI Cache</h2>
        <p><strong>Location</strong>:</p>
        <pre><code>NTUSER.DAT\Software\Classes\Local Settings\Software\Microsoft\Windows\Shell\MuiCache
UsrClass.dat\Local Settings\Software\Microsoft\Windows\Shell\MuiCache
</code></pre>
        <p><strong>Content</strong>:</p>
        <ul>
            <li>Executable friendly names</li>
            <li>Application descriptions</li>
            <li>Evidence of execution</li>
        </ul>
        <hr />
        <h1>üîÑ Persistence Mechanisms</h1>
        <h2>Common Persistence Locations</h2>
        <h3>Run Keys</h3>
        <pre><code># HKCU (per user)
NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Run
NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\RunOnce
NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\RunOnceEx

# HKLM (all users)
SOFTWARE\Microsoft\Windows\CurrentVersion\Run
SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce
SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnceEx

# WOW64 (32-bit on 64-bit)
SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\Run

# Policies
SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run
NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run
</code></pre>
        <h3>Services</h3>
        <p><strong>Registry Location</strong>:</p>
        <pre><code>SYSTEM\CurrentControlSet\Services\{ServiceName}
- ImagePath: Executable path
- Start: 0=Boot, 1=System, 2=Auto, 3=Manual, 4=Disabled
- Type: Service type
</code></pre>
        <p><strong>Event Log</strong>: System Event ID 7045 (Service Install)</p>
        <p><strong>Analysis</strong>:</p>
        <pre><code class="language-powershell"># List services
Get-Service | Select-Object Name, Status, StartType, PathName

# WMI
Get-WmiObject Win32_Service | Select-Object Name, PathName, StartMode
</code></pre>
        <h3>Scheduled Tasks</h3>
        <p><strong>Locations</strong>:</p>
        <pre><code>File System: C:\Windows\System32\Tasks\
C:\Windows\Tasks\

Registry:
SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks\
SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree\
</code></pre>
        <p><strong>Event Log</strong>: TaskScheduler/Operational, Security 4698/4699/4702</p>
        <p><strong>Analysis</strong>:</p>
        <pre><code class="language-powershell"># List scheduled tasks
Get-ScheduledTask | Select-Object TaskName, State, TaskPath

# Task details
Get-ScheduledTask -TaskName "TaskName" | Get-ScheduledTaskInfo
</code></pre>
        <h3>Startup Folders</h3>
        <pre><code># Per user
C:\Users\&lt;user&gt;\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\

# All users
C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Startup\
</code></pre>
        <h3>Winlogon</h3>
        <pre><code>SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon
- Shell (default: explorer.exe)
- Userinit (default: C:\Windows\system32\userinit.exe,)
</code></pre>
        <h3>Image File Execution Options (IFEO)</h3>
        <pre><code>SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\{process.exe}
- Debugger: Path to "debugger" (actually hijacker)

SOFTWARE\Microsoft\Windows NT\CurrentVersion\SilentProcessExit\{process.exe}
- MonitorProcess: Process to run on exit
</code></pre>
        <h3>AppInit_DLLs</h3>
        <pre><code>SOFTWARE\Microsoft\Windows NT\CurrentVersion\Windows
- AppInit_DLLs: DLL paths loaded into every process using User32.dll
- LoadAppInit_DLLs: Enable flag

SOFTWARE\WOW6432Node\Microsoft\Windows NT\CurrentVersion\Windows
- Same for 32-bit
</code></pre>
        <h3>COM Object Hijacking</h3>
        <pre><code># HKCU takes precedence over HKLM
NTUSER.DAT\Software\Classes\CLSID\{GUID}\InprocServer32
- (Default): Path to DLL

SOFTWARE\Classes\CLSID\{GUID}\InprocServer32
</code></pre>
        <h3>WMI Event Subscriptions</h3>
        <pre><code class="language-powershell"># List WMI subscriptions
Get-WMIObject -Namespace root\Subscription -Class __EventFilter
Get-WMIObject -Namespace root\Subscription -Class __EventConsumer
Get-WMIObject -Namespace root\Subscription -Class __FilterToConsumerBinding
</code></pre>
        <p><strong>File Location</strong>: <code>C:\Windows\System32\wbem\Repository\</code></p>
        <h3>Print Monitors</h3>
        <pre><code>SYSTEM\CurrentControlSet\Control\Print\Monitors\{MonitorName}
- Driver: DLL path
</code></pre>
        <h3>LSA Security Packages</h3>
        <pre><code>SYSTEM\CurrentControlSet\Control\Lsa
- Authentication Packages
- Security Packages
</code></pre>
        <h3>BootExecute</h3>
        <pre><code>SYSTEM\CurrentControlSet\Control\Session Manager
- BootExecute: Programs run at boot (normally: autocheck autochk *)
</code></pre>
        <h3>DLL Search Order Hijacking</h3>
        <p>Common hijackable DLL locations:</p>
        <pre><code>1. Application directory
2. C:\Windows\System32
3. C:\Windows\System
4. C:\Windows
5. Current directory
6. PATH directories
</code></pre>
        <h2>Persistence Detection Checklist</h2>
        <table>
            <thead>
                <tr>
                    <th>Location</th>
                    <th>Registry/File Path</th>
                    <th>Tool</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Run Keys</td>
                    <td>Multiple registry locations</td>
                    <td>RECmd, Registry Explorer</td>
                </tr>
                <tr>
                    <td>Services</td>
                    <td>SYSTEM hive, Event 7045</td>
                    <td>Registry Explorer, EvtxECmd</td>
                </tr>
                <tr>
                    <td>Scheduled Tasks</td>
                    <td>Tasks folder, TaskScheduler logs</td>
                    <td>Task folder, Event logs</td>
                </tr>
                <tr>
                    <td>Startup Folders</td>
                    <td>Start Menu\Programs\Startup</td>
                    <td>File system analysis</td>
                </tr>
                <tr>
                    <td>Winlogon</td>
                    <td>SOFTWARE hive</td>
                    <td>Registry Explorer</td>
                </tr>
                <tr>
                    <td>IFEO</td>
                    <td>SOFTWARE hive</td>
                    <td>Registry Explorer</td>
                </tr>
                <tr>
                    <td>WMI</td>
                    <td>WMI Repository</td>
                    <td>PowerShell, autoruns</td>
                </tr>
                <tr>
                    <td>COM Hijacking</td>
                    <td>CLSID entries</td>
                    <td>Registry Explorer</td>
                </tr>
            </tbody>
        </table>
        <hr />
        <h1>ü¶† Malware Indicators</h1>
        <h2>Suspicious Locations</h2>
        <pre><code>High-Risk Paths:
C:\Users\&lt;user&gt;\AppData\Local\Temp\
C:\Users\&lt;user&gt;\AppData\Roaming\
C:\Windows\Temp\
C:\ProgramData\
C:\Users\Public\
%USERPROFILE%\

Commonly Abused Legitimate Paths:
C:\Windows\System32\
C:\Windows\SysWOW64\
C:\Windows\Tasks\
C:\Windows\Debug\

Suspicious Patterns:
- Random alphanumeric names: a1b2c3d4.exe
- Misspelled system files: scvhost.exe (not svchost.exe)
- Hidden folders: .hidden\
- Double extensions: document.pdf.exe
- Excessive path depth
- Non-ASCII characters in path
</code></pre>
        <h2>Process Anomalies to Look For</h2>
        <h3>Parent-Child Relationship Anomalies</h3>
        <table>
            <thead>
                <tr>
                    <th>Process</th>
                    <th>Expected Parent</th>
                    <th>Suspicious If</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>svchost.exe</code></td>
                    <td><code>services.exe</code></td>
                    <td>Any other parent</td>
                </tr>
                <tr>
                    <td><code>smss.exe</code></td>
                    <td><code>System</code></td>
                    <td>Any other parent</td>
                </tr>
                <tr>
                    <td><code>csrss.exe</code></td>
                    <td><code>Created by smss.exe</code></td>
                    <td>Any other parent visible</td>
                </tr>
                <tr>
                    <td><code>wininit.exe</code></td>
                    <td><code>smss.exe</code></td>
                    <td>Any other parent</td>
                </tr>
                <tr>
                    <td><code>winlogon.exe</code></td>
                    <td><code>smss.exe</code></td>
                    <td>Any other parent</td>
                </tr>
                <tr>
                    <td><code>lsass.exe</code></td>
                    <td><code>wininit.exe</code></td>
                    <td>Any other parent</td>
                </tr>
            </tbody>
        </table>
    </div>
    <footer class="signature-footer">
        <p class="copyright-text">¬© 2026 // ALL_RIGHTS_RESERVED <span class="hex-badge">v1.0</span></p>

        <div class="signature-wrapper" id="signatureWrapper" onclick="playSignature()">

            <!-- Sparkle effects -->
            <div class="sig-sparkle"></div>
            <div class="sig-sparkle"></div>
            <div class="sig-sparkle"></div>
            <div class="sig-sparkle"></div>
            <div class="sig-sparkle"></div>

            <!-- Pen cursor -->
            <span class="pen-cursor" id="penCursor">üñäÔ∏è</span>

            <!-- Main SVG Signature -->
            <svg class="signature-svg" id="signatureSvg" width="340" height="90" viewBox="0 0 340 90">
                <defs>
                    <linearGradient id="sig-gradient" x1="0%" y1="0%" x2="100%" y2="0%">
                        <stop offset="0%" stop-color="var(--cy)" />
                        <stop offset="35%" stop-color="var(--lm)" />
                        <stop offset="65%" stop-color="var(--mg)" />
                        <stop offset="100%" stop-color="var(--cy)" />
                    </linearGradient>
                </defs>

                <!-- Handwritten: 0xF4d3Z0n3 -->
                <path id="signaturePath" class="signature-path idle" d="
              M 18,42
              C 18,28 38,24 42,38
              C 46,52 38,62 28,62
              C 18,62 14,52 18,42
              
              M 54,32
              L 72,58
              M 72,32
              L 54,58
              
              M 84,28
              L 84,62
              M 84,28
              L 108,28
              M 84,44
              L 102,44
              
              M 138,28
              L 114,52
              L 142,52
              M 134,28
              L 134,62
              
              M 172,24
              L 172,62
              C 172,62 172,48 160,48
              C 148,48 148,62 160,62
              C 172,62 172,52 172,52
              
              M 186,34
              C 200,30 206,36 198,44
              C 206,48 204,62 186,58
              
              M 218,30
              L 244,30
              L 218,60
              L 244,60
              
              M 258,46
              C 258,32 278,28 282,42
              C 286,56 274,66 262,64
              C 250,62 254,50 258,46
              
              M 296,46
              L 296,62
              M 296,46
              C 296,36 314,36 314,46
              L 314,62
              
              M 328,34
              C 342,30 348,36 340,44
              C 348,48 346,62 328,58
            " />

                <!-- Underline flourish -->
                <path id="flourishPath" class="flourish-path idle" d="M 20,75 
               Q 100,82 180,72 
               Q 260,62 320,75
               C 330,77 328,72 322,70" />
            </svg>
        </div>

        <p class="click-hint" id="clickHint">[ <span>click</span> to sign // <span>space</span> ]</p>

        <!-- Particles container -->
        <div id="inkParticles" style="position:absolute;inset:0;pointer-events:none;"></div>
    </footer>
    <script>
        const state = {
            favorites: JSON.parse(localStorage.getItem('forensicsFavorites') || '[]'),
            isDark: localStorage.getItem('forensicsTheme') !== 'light',
            konamiProgress: 0,
            konamiCode: [38, 38, 40, 40, 37, 39, 37, 39, 66, 65],
            matrixActive: false,
            showingFavorites: false
        };

        document.addEventListener('DOMContentLoaded', () => {
            initSections();
            addCopyButtons();
            applySyntax();
            initTheme();
            initFavorites();
            initScrollObserver();
            initProgressBar();
        });

        /* ===== SECTION INITIALIZATION ===== */
        function initSections() {
            const main = document.getElementById('main-content');
            const children = Array.from(main.children);
            const secs = [];
            let curSec = null;
            let curBody = null;

            children.forEach(el => {
                if (el.tagName === 'H1') {
                    if (curSec && curBody) {
                        curSec.appendChild(curBody);
                        secs.push(curSec);
                    }
                    const text = el.textContent.trim();
                    const id = getSectionId(text);

                    curSec = document.createElement('div');
                    curSec.className = 'content-section fade-in';
                    curSec.id = id;

                    const header = document.createElement('div');
                    header.className = 'section-header';
                    header.innerHTML = `<span>${text}</span>` +
                        '<button class="fav-btn" title="Toggle Favorite">&#9733;</button>' +
                        '<span class="section-toggle">&#9660;</span>';

                    // Fix: capture section ID and element in closure safely
                    const thisSecId = id;
                    const thisSecEl = curSec;

                    const favBtn = header.querySelector('.fav-btn');
                    favBtn.addEventListener('click', function (e) {
                        e.stopPropagation();
                        toggleFavorite(thisSecId, this);
                    });
                    header.addEventListener('click', function (e) {
                        if (e.target.closest('.fav-btn')) return;
                        toggleSection(thisSecEl);
                    });

                    curSec.appendChild(header);
                    curBody = document.createElement('div');
                    curBody.className = 'section-body';
                } else if (curBody) {
                    // Move node directly instead of cloning (avoids duplicate DOM)
                    curBody.appendChild(el);
                }
            });

            if (curSec && curBody) {
                curSec.appendChild(curBody);
                secs.push(curSec);
            }

            main.innerHTML = '';
            secs.forEach(sec => {
                const body = sec.querySelector('.section-body');
                if (body) wrapInCards(body);
                main.appendChild(sec);
            });
        }

        function wrapInCards(body) {
            const children = Array.from(body.children);
            let card = null;
            const frag = document.createDocumentFragment();

            children.forEach(el => {
                if (el.tagName === 'H2') {
                    if (card) frag.appendChild(card);
                    card = document.createElement('div');
                    card.className = 'card';
                    card.appendChild(el);
                } else if (el.tagName === 'HR') {
                    if (card) { frag.appendChild(card); card = null; }
                } else if (card) {
                    card.appendChild(el);
                } else {
                    card = document.createElement('div');
                    card.className = 'card';
                    card.appendChild(el);
                }
            });
            if (card) frag.appendChild(card);
            body.innerHTML = '';
            body.appendChild(frag);
        }

        /* ===== SECTION ID GENERATION ===== */
        const usedIds = new Set();

        function getSectionId(text) {
            // Remove emojis and special chars, keep alphanumeric
            let baseId = text.replace(/[\u{1F300}-\u{1F9FF}]/gu, '') // Remove emojis
                .toLowerCase()
                .replace(/[^a-z0-9]+/g, '-')
                .replace(/^-|-$/g, '');

            if (!baseId) baseId = 'section';

            let id = baseId;
            let counter = 2;

            while (usedIds.has(id)) {
                id = `${baseId}-${counter}`;
                counter++;
            }

            usedIds.add(id);
            return id;
        }

        /* ===== SECTION TOGGLING ===== */
        function toggleSection(section) {
            const body = section.querySelector('.section-body');
            const toggle = section.querySelector('.section-toggle');
            if (!body || !toggle) return;

            if (body.classList.contains('collapsed')) {
                body.classList.remove('collapsed');
                toggle.classList.remove('collapsed');
                body.style.maxHeight = body.scrollHeight + 'px';
                setTimeout(() => { if (!body.classList.contains('collapsed')) body.style.maxHeight = 'none'; }, 500);
            } else {
                body.style.maxHeight = body.scrollHeight + 'px';
                body.offsetHeight; // force reflow
                body.classList.add('collapsed');
                toggle.classList.add('collapsed');
            }
        }

        function expandSection(section) {
            if (!section) return;
            const body = section.querySelector('.section-body');
            const toggle = section.querySelector('.section-toggle');
            if (body && body.classList.contains('collapsed')) {
                body.classList.remove('collapsed');
                if (toggle) toggle.classList.remove('collapsed');
                body.style.maxHeight = 'none'; // Instant expand for scrolling
            }
        }

        function toggleAllSections(expand) {
            document.querySelectorAll('.content-section').forEach(sec => {
                const body = sec.querySelector('.section-body');
                const toggle = sec.querySelector('.section-toggle');
                if (!body || !toggle) return;
                if (expand) {
                    body.classList.remove('collapsed');
                    toggle.classList.remove('collapsed');
                    body.style.maxHeight = 'none';
                } else {
                    body.style.maxHeight = body.scrollHeight + 'px';
                    body.offsetHeight;
                    body.classList.add('collapsed');
                    toggle.classList.add('collapsed');
                }
            });
        }

        function scrollToSection(id) {
            const el = document.getElementById(id);
            if (!el) return;
            expandSection(el);
            // Slight delay to allow layout update if needed, but 'none' max-height should be instant
            el.scrollIntoView({ behavior: 'smooth', block: 'start' });
            updateActiveTab(id);
        }

        function updateActiveTab(id) {
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.toggle('active', tab.dataset.section === id);
            });
        }

        /* ===== COPY BUTTONS with file:// fallback ===== */
        function copyText(text) {
            if (navigator.clipboard && navigator.clipboard.writeText && location.protocol !== 'file:') {
                return navigator.clipboard.writeText(text).catch(() => fallbackCopy(text));
            }
            return fallbackCopy(text);
        }

        function fallbackCopy(text) {
            return new Promise((resolve, reject) => {
                const ta = document.createElement('textarea');
                ta.value = text;
                ta.style.cssText = 'position:fixed;left:-9999px;top:-9999px;opacity:0';
                document.body.appendChild(ta);
                ta.select();
                try { document.execCommand('copy'); resolve(); }
                catch (e) { reject(e); }
                finally { document.body.removeChild(ta); }
            });
        }

        function addCopyButtons() {
            document.querySelectorAll('pre').forEach(pre => {
                const btn = document.createElement('button');
                btn.className = 'copy-btn';
                btn.textContent = '\u{1F4CB} Copy';
                btn.addEventListener('click', function () {
                    const code = pre.querySelector('code');
                    const text = code ? code.textContent : pre.textContent;
                    copyText(text).then(() => {
                        btn.textContent = '\u2705 Copied!';
                        btn.classList.add('copied');
                        showToast('Copied to clipboard!');
                        setTimeout(() => { btn.textContent = '\u{1F4CB} Copy'; btn.classList.remove('copied'); }, 2000);
                    }).catch(() => showToast('Copy failed'));
                });
                pre.style.position = 'relative';
                pre.appendChild(btn);
            });
        }

        /* ===== SYNTAX HIGHLIGHTING (safe, text-node based) ===== */
        function applySyntax() {
            document.querySelectorAll('pre code').forEach(block => {
                const walker = document.createTreeWalker(block, NodeFilter.SHOW_TEXT, null, false);
                const textNodes = [];
                let node;
                while (node = walker.nextNode()) textNodes.push(node);

                textNodes.forEach(textNode => {
                    const text = textNode.textContent;
                    if (!text.trim()) return;

                    const lines = text.split('\n');
                    const frag = document.createDocumentFragment();

                    lines.forEach((line, idx) => {
                        if (idx > 0) frag.appendChild(document.createTextNode('\n'));

                        // Shell/PowerShell comments
                        const commentMatch = line.match(/^(\s*)(#.*)$/);
                        if (commentMatch) {
                            if (commentMatch[1]) frag.appendChild(document.createTextNode(commentMatch[1]));
                            const span = document.createElement('span');
                            span.style.cssText = 'color:#6a7a8a;font-style:italic';
                            span.textContent = commentMatch[2];
                            frag.appendChild(span);
                            return;
                        }

                        // CMD comments
                        const cmdMatch = line.match(/^(\s*)(::.*|REM\s.*)$/i);
                        if (cmdMatch) {
                            if (cmdMatch[1]) frag.appendChild(document.createTextNode(cmdMatch[1]));
                            const span = document.createElement('span');
                            span.style.cssText = 'color:#6a7a8a;font-style:italic';
                            span.textContent = cmdMatch[2];
                            frag.appendChild(span);
                            return;
                        }

                        // Highlight flags and strings in non-comment lines
                        // Regex improved to avoid matching apostrophes in words (e.g. don't)
                        const parts = line.split(/(--?\w[\w-]*|"[^"]*"|(?<!\w)'[^']*')/g);
                        parts.forEach(part => {
                            if (/^--?\w/.test(part)) {
                                const span = document.createElement('span');
                                span.style.color = 'var(--og)';
                                span.textContent = part;
                                frag.appendChild(span);
                            } else if (/^["']/.test(part)) {
                                const span = document.createElement('span');
                                span.style.color = 'var(--lm)';
                                span.textContent = part;
                                frag.appendChild(span);
                            } else {
                                frag.appendChild(document.createTextNode(part));
                            }
                        });
                    });

                    textNode.parentNode.replaceChild(frag, textNode);
                });
            });
        }

        /* ===== SEARCH ===== */
        let searchHits = [];
        let searchHitIndex = 0;

        function clearLineHighlights(card) {
            card.querySelectorAll('.line-highlight').forEach(el => el.classList.remove('line-highlight', 'line-highlight-active'));
            card.querySelectorAll('pre code[data-original]').forEach(el => {
                el.innerHTML = el.getAttribute('data-original');
                el.removeAttribute('data-original');
            });
        }

        function navigateHit(dir) {
            if (!searchHits.length) return;
            searchHits[searchHitIndex].classList.remove('line-highlight-active');
            searchHitIndex = (searchHitIndex + dir + searchHits.length) % searchHits.length;
            const target = searchHits[searchHitIndex];
            target.classList.add('line-highlight-active');
            target.scrollIntoView({ behavior: 'smooth', block: 'center' });
            updateNavUI();
        }

        function updateNavUI() {
            const nav = document.getElementById('search-nav');
            const label = document.getElementById('search-nav-label');
            const prev = document.getElementById('search-prev');
            const next = document.getElementById('search-next');
            if (searchHits.length > 1) {
                nav.classList.add('visible');
                label.textContent = (searchHitIndex + 1) + ' / ' + searchHits.length;
                prev.disabled = false;
                next.disabled = false;
            } else {
                nav.classList.remove('visible');
            }
        }

        function highlightLines(card, query) {
            const lowerQuery = query.toLowerCase();

            // Highlight matching block-level elements (table rows, list items, paragraphs)
            card.querySelectorAll('tr, li, p, dt, dd').forEach(el => {
                if (el.textContent.toLowerCase().includes(lowerQuery))
                    el.classList.add('line-highlight');
            });

            // Highlight matching lines inside <pre><code> blocks
            card.querySelectorAll('pre code').forEach(codeEl => {
                if (!codeEl.hasAttribute('data-original'))
                    codeEl.setAttribute('data-original', codeEl.innerHTML);
                const lines = codeEl.innerHTML.split('\n');
                codeEl.innerHTML = lines.map(line => {
                    const tmp = document.createElement('div');
                    tmp.innerHTML = line;
                    return tmp.textContent.toLowerCase().includes(lowerQuery)
                        ? `<span class="line-highlight">${line}</span>`
                        : line;
                }).join('\n');
            });
        }

        document.getElementById('search-box').addEventListener('input', function () {
            const query = this.value.trim().toLowerCase();
            const sections = document.querySelectorAll('.content-section');
            let totalMatches = 0;

            document.querySelectorAll('.card').forEach(c => clearLineHighlights(c));
            searchHits = [];
            searchHitIndex = 0;
            document.getElementById('search-nav').classList.remove('visible');

            if (!query) {
                sections.forEach(s => s.style.display = '');
                document.querySelectorAll('.card').forEach(c => c.style.display = '');
                document.getElementById('search-count').textContent = '';
                return;
            }

            sections.forEach(section => {
                const cards = section.querySelectorAll('.card');
                let sectionHasMatch = false;
                cards.forEach(card => {
                    const text = card.textContent.toLowerCase();
                    if (text.includes(query)) {
                        card.style.display = '';
                        sectionHasMatch = true;
                        totalMatches++;
                        highlightLines(card, query);
                    } else {
                        card.style.display = 'none';
                    }
                });
                section.style.display = sectionHasMatch ? '' : 'none';
                if (sectionHasMatch) expandSection(section);
            });

            document.getElementById('search-count').textContent =
                totalMatches > 0 ? totalMatches + ' card(s) found' : 'No results found';

            // Collect all highlighted lines after DOM settles, then jump to first
            setTimeout(() => {
                searchHits = Array.from(document.querySelectorAll('.line-highlight'));
                searchHitIndex = 0;
                if (searchHits.length) {
                    searchHits[0].classList.add('line-highlight-active');
                    searchHits[0].scrollIntoView({ behavior: 'smooth', block: 'center' });
                    updateNavUI();
                }
            }, 50);
        });

        /* ===== THEME ===== */
        function initTheme() {
            if (!state.isDark) {
                document.body.classList.add('light-mode');
                document.getElementById('theme-btn').textContent = '\u2600\uFE0F';
            }
        }

        function toggleTheme() {
            state.isDark = !state.isDark;
            document.body.classList.toggle('light-mode');
            document.getElementById('theme-btn').textContent = state.isDark ? '\u{1F319}' : '\u2600\uFE0F';
            localStorage.setItem('forensicsTheme', state.isDark ? 'dark' : 'light');
            showToast(state.isDark ? 'Dark mode enabled' : 'Light mode enabled');
        }

        /* ===== FAVORITES ===== */
        function initFavorites() {
            state.favorites.forEach(id => {
                const sec = document.getElementById(id);
                if (sec) {
                    const btn = sec.querySelector('.fav-btn');
                    if (btn) btn.classList.add('active');
                }
            });
        }

        function toggleFavorite(id, btn) {
            const idx = state.favorites.indexOf(id);
            if (idx > -1) {
                state.favorites.splice(idx, 1);
                btn.classList.remove('active');
                showToast('Removed from favorites');
            } else {
                state.favorites.push(id);
                btn.classList.add('active');
                showToast('Added to favorites!');
            }
            localStorage.setItem('forensicsFavorites', JSON.stringify(state.favorites));
        }

        function showFavorites() {
            state.showingFavorites = !state.showingFavorites;
            const sections = document.querySelectorAll('.content-section');
            if (state.showingFavorites && state.favorites.length > 0) {
                sections.forEach(sec => {
                    sec.style.display = state.favorites.includes(sec.id) ? '' : 'none';
                });
                showToast('Showing favorites only');
            } else {
                sections.forEach(sec => sec.style.display = '');
                if (state.showingFavorites) {
                    showToast('No favorites yet!');
                    state.showingFavorites = false;
                } else {
                    showToast('Showing all sections');
                }
            }
        }

        /* ===== TOAST ===== */
        function showToast(msg) {
            const t = document.getElementById('toast');
            t.textContent = msg;
            t.classList.add('show');
            clearTimeout(t._t);
            t._t = setTimeout(() => t.classList.remove('show'), 2500);
        }

        /* ===== KEYBOARD SHORTCUTS ===== */
        document.addEventListener('keydown', e => {
            if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
                e.preventDefault();
                const sb = document.getElementById('search-box');
                sb.focus();
                sb.select();
                return;
            }
            if (e.key === 'Escape') {
                document.getElementById('search-box').blur();
                if (state.matrixActive) stopMatrix();
                return;
            }
            // Konami code
            if (e.keyCode === state.konamiCode[state.konamiProgress]) {
                state.konamiProgress++;
                if (state.konamiProgress === state.konamiCode.length) {
                    state.konamiProgress = 0;
                    toggleMatrix();
                }
            } else {
                state.konamiProgress = 0;
            }
        });

        /* ===== SCROLL OBSERVER ===== */
        function initScrollObserver() {
            // Use threshold 0 to trigger as soon as any pixel is visible
            const obs = new IntersectionObserver(entries => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('visible');
                        if (entry.target.classList.contains('content-section'))
                            updateActiveTab(entry.target.id);
                    }
                });
            }, { threshold: 0, rootMargin: '0px' });

            // Observe immediately
            document.querySelectorAll('.fade-in').forEach(el => obs.observe(el));

            // Safety fallback: ensure all sections are visible after a short delay
            // This prevents "glitches" where the observer might miss an initial state
            setTimeout(() => {
                document.querySelectorAll('.content-section').forEach(el => el.classList.add('visible'));
            }, 500);
        }

        /* ===== PROGRESS BAR ===== */
        function initProgressBar() {
            window.addEventListener('scroll', () => {
                const scrollTop = window.scrollY;
                const docHeight = document.documentElement.scrollHeight - window.innerHeight;
                const progress = docHeight > 0 ? (scrollTop / docHeight) * 100 : 0;
                document.getElementById('progress-bar').style.width = progress + '%';
            });
        }

        /* ===== MATRIX RAIN EASTER EGG ===== */
        function toggleMatrix() { state.matrixActive ? stopMatrix() : startMatrix(); }

        function startMatrix() {
            state.matrixActive = true;
            const canvas = document.getElementById('matrix-canvas');
            canvas.classList.add('active');
            const ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            const cols = Math.floor(canvas.width / 16);
            const drops = new Array(cols).fill(1);
            const chars = '\u30A2\u30A4\u30A6\u30A8\u30AA\u30AB\u30AD\u30AF01ABCDEF';
            state.matrixInterval = setInterval(() => {
                ctx.fillStyle = 'rgba(0,0,0,0.05)';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                ctx.fillStyle = '#0f0';
                ctx.font = '14px monospace';
                for (let i = 0; i < drops.length; i++) {
                    const t = chars[Math.floor(Math.random() * chars.length)];
                    ctx.fillText(t, i * 16, drops[i] * 16);
                    if (drops[i] * 16 > canvas.height && Math.random() > 0.975) drops[i] = 0;
                    drops[i]++;
                }
            }, 45);
            showToast('Matrix mode! Press Escape to exit');
            setTimeout(() => { if (state.matrixActive) stopMatrix(); }, 15000);
        }

        function stopMatrix() {
            state.matrixActive = false;
            const canvas = document.getElementById('matrix-canvas');
            canvas.classList.remove('active');
            clearInterval(state.matrixInterval);
            canvas.getContext('2d').clearRect(0, 0, canvas.width, canvas.height);
        }

        window.addEventListener('resize', () => {
            const c = document.getElementById('matrix-canvas');
            if (state.matrixActive) { c.width = window.innerWidth; c.height = window.innerHeight; }
        });
        /* ===== FOOTER SIGNATURE ===== */
        let sigAnimating = false;

        function playSignature() {
            if (sigAnimating) return;
            sigAnimating = true;

            const sigPath = document.getElementById('signaturePath');
            const flourish = document.getElementById('flourishPath');
            const pen = document.getElementById('penCursor');
            const hint = document.getElementById('clickHint');
            const svg = document.getElementById('signatureSvg');

            // Hide hint & stop idle
            hint.classList.add('hidden');
            svg.style.animation = 'none';

            // Remove idle, add drawing class
            [sigPath, flourish].forEach(el => {
                el.classList.remove('idle');
                void el.offsetWidth;
                el.classList.add('drawing');
            });

            // Activate pen
            pen.classList.add('active');

            // Spawn ink particles
            spawnInkParticles();

            // Reset after animation
            setTimeout(() => {
                [sigPath, flourish].forEach(el => {
                    el.classList.remove('drawing');
                    el.classList.add('idle');
                });
                pen.classList.remove('active');
                hint.classList.remove('hidden');
                svg.style.animation = '';
                sigAnimating = false;
            }, 5000);
        }

        function spawnInkParticles() {
            const container = document.getElementById('inkParticles');
            const wrapper = document.getElementById('signatureWrapper');
            if (!container || !wrapper) return;

            const rect = wrapper.getBoundingClientRect();
            const colors = ['#00ffff', '#ff00ff', '#00ff88'];

            for (let i = 0; i < 30; i++) {
                setTimeout(() => {
                    const particle = document.createElement('div');
                    particle.className = 'ink-particle';

                    const progress = i / 30;
                    particle.style.left = `${rect.left + (rect.width * progress) + (Math.random() - 0.5) * 40}px`;
                    particle.style.top = `${rect.top + rect.height * 0.5 + (Math.random() - 0.5) * 30}px`;

                    particle.style.setProperty('--tx', `${(Math.random() - 0.5) * 60}px`);
                    particle.style.setProperty('--ty', `${(Math.random() - 0.5) * 60}px`);

                    particle.style.background = colors[Math.floor(Math.random() * colors.length)];
                    particle.style.boxShadow = `0 0 6px ${particle.style.background}`;

                    container.appendChild(particle);
                    setTimeout(() => particle.classList.add('active'), 10);
                    setTimeout(() => particle.remove(), 800);
                }, i * 130);
            }
        }

        document.addEventListener('keydown', (e) => {
            if (e.code === 'Space' && !e.target.matches('input, textarea')) {
                e.preventDefault();
                playSignature();
            }
        });

    </script>

    <div class="search-nav" id="search-nav">
        <span class="search-nav-title">Results</span>
        <button class="search-nav-btn" id="search-prev" onclick="navigateHit(-1)" title="Previous result">&#8593; Prev</button>
        <span class="search-nav-label" id="search-nav-label">1 / 1</span>
        <button class="search-nav-btn" id="search-next" onclick="navigateHit(1)" title="Next result">Next &#8595;</button>
    </div>
</body>

</html>
